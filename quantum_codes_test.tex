\documentclass[11pt]{article}
\usepackage{booktabs}
\usepackage{fullpage}
\usepackage{titlesec}
%\newcommand{\sectionbreak}{\clearpage}
\usepackage{amsmath,amsfonts,amsthm,mathrsfs,xspace,graphicx}
\usepackage[backref,colorlinks,citecolor=blue,bookmarks=true]{hyperref}
\usepackage{mathpazo}
\usepackage{endnotes}
\usepackage{color}
\usepackage{float}
\usepackage{xcolor}
\usepackage{mdframed}
\usepackage{bbm}
\usepackage{suffix} % for *-version commands
\usepackage{times}
\usepackage{tabularx}
\usepackage{makecell}
\usepackage{amssymb,latexsym}
%\usepackage{IEEEtrantools}
\usepackage[capitalize]{cleveref}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage[affil-it]{authblk}


\mdfdefinestyle{figstyle}{ %
  linecolor=black!7, %
  backgroundcolor=black!7, %
  innertopmargin=10pt, %
  innerleftmargin=25pt, %
  innerrightmargin=25pt, %
  innerbottommargin=10pt %
}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{corollary}[theorem]{Corollary}

\newtheorem{remark}[theorem]{Remark}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}

\newcommand{\beq}{\begin{eqnarray}}
\newcommand{\eeq}{\end{eqnarray}}

\newcommand{\code}{\mathcal{C}}
\newcommand{\strategy}{\mathscr{S}}
\newcommand{\algebra}{\mathscr{A}}

\newcommand{\ket}[1]{|#1\rangle}
\newcommand{\bra}[1]{\langle#1|}
\newcommand{\ketbra}[2]{\ket{#1}\!\bra{#2}}
\newcommand{\ip}[2]{\langle #1 \! | #2 \rangle}
\newcommand{\proj}[1]{\ket{#1}\!\bra{#1}}
\newcommand{\Tr}{\mbox{\rm Tr}}
\newcommand{\Id}{\ensuremath{I}}
\DeclareMathOperator*{\Expectation}{\mathbb{E}}
\newcommand{\Es}[1]{\Expectation_{#1}}

\newcommand{\reg}[1]{{\textsf{#1}}}
\newcommand{\ol}[1]{\overline{#1}}

\newcommand{\field}{\mathbb{F}}
\newcommand{\C}{\ensuremath{\mathbb{C}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\bbN}{\ensuremath{\mathbb{N}}}
\newcommand{\complex}{\ensuremath{\mathbb{C}}}
\newcommand{\real}{\ensuremath{\mathbb{R}}}
%\newcommand{\natural}{\ensuremath{\mathbb{N}}}

\newcommand{\bij}{\pi}
\newcommand{\qp}{\tau}
\newcommand{\dlS}{\ensuremath{\rm dlS}}

\newcommand{\F}{\ensuremath{\mathbb{F}}}
\newcommand{\M}{\ensuremath{\mathbb{M}}}
\newcommand{\ot}{\otimes}
\newcommand{\Fp}{\F_p}
\newcommand{\Fq}{\field}
\newcommand{\BH}{\textsc{BH}}
\newcommand{\ld}{\textsc{ld}}
\newcommand{\downsize}{\kappa}
\newcommand{\tobin}{\flat}
\newcommand{\downsizem}{\chi}

\newcommand{\K}{\ensuremath{\mathbb{K}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}

\newcommand{\mA}{\ensuremath{\mathcal{A}}}
\newcommand{\mB}{\ensuremath{\mathcal{B}}}
\newcommand{\mC}{\ensuremath{\mathcal{C}}}
\newcommand{\mE}{\ensuremath{\mathcal{E}}}
\newcommand{\mD}{\ensuremath{\mathcal{D}}}
\newcommand{\mF}{\ensuremath{\mathcal{F}}}
\newcommand{\mG}{\ensuremath{\mathcal{G}}}
\newcommand{\mH}{\ensuremath{\mathcal{H}}}
\newcommand{\mK}{\ensuremath{\mathcal{K}}}
\newcommand{\mM}{\ensuremath{\mathcal{M}}}
\newcommand{\mI}{\ensuremath{\mathcal{I}}}
\newcommand{\cM}{\ensuremath{\mathcal{M}}}
\newcommand{\mQ}{\ensuremath{\mathcal{Q}}}
\newcommand{\mR}{\ensuremath{\mathcal{R}}}
\newcommand{\mS}{\ensuremath{\mathcal{S}}}
\newcommand{\mT}{\ensuremath{\mathcal{T}}}
\newcommand{\mX}{\ensuremath{\mathcal{X}}}
\newcommand{\mY}{\ensuremath{\mathcal{Y}}}

\newcommand{\Inv}{\ensuremath{\textsc{Inv}}}
\newcommand{\GEN}{\ensuremath{\textsc{GEN}}}
\newcommand{\SAMP}{\ensuremath{\textsc{SAMP}}}
\newcommand{\epr}{\ensuremath{\textsc{epr}}}

\newcommand{\Alg}{\mathcal{A}}
\newcommand{\ind}{\ensuremath{\mathrm{ind}}}


\newcommand{\setft}[1]{\mathrm{#1}}
\newcommand{\Density}{\setft{D}}
\newcommand{\Pos}{\setft{Pos}}
\newcommand{\Proj}{\setft{Proj}}
\newcommand{\Channel}{\setft{C}}
\newcommand{\Unitary}{\setft{U}}
\newcommand{\Herm}{\setft{Herm}}
\newcommand{\Lin}{\setft{L}}
\newcommand{\Trans}{\setft{T}}
\DeclareMathOperator{\poly}{poly}
\DeclareMathOperator{\negl}{negl}
\newcommand{\dset}{G}

\newcommand{\val}{\ensuremath{\mathrm{val}}}
\newcommand{\valco}{\ensuremath{\mathrm{val}^{\mathrm{co}}}}
\newcommand{\ia}{\Id_\alice}
\newcommand{\ib}{\Id_\bob}

\newcommand{\desc}[1]{\overline{\cal{#1}}}
\newcommand{\supp}{\textsc{Supp}}
\newcommand{\Gen}{\textsc{Gen}}
\newcommand{\Enc}{\textsc{Enc}}
\newcommand{\Dec}{\textsc{Dec}}

\newcommand{\GenTrap}{\textsc{GenTrap}}
\newcommand{\Invert}{\textsc{Invert}}
\newcommand{\lossy}{\textsc{lossy}}

\newcommand{\rand}{\textrm{rand}}
\newcommand{\had}{\textsc{Had}}


\newcommand{\eps}{\varepsilon}
\newcommand{\ph}{\ensuremath{\varphi}}


\newcommand{\ac}{\textsc{ac}}
\newcommand{\GX}{\textsc{Gap-Maxcut}}
\newcommand{\GNI}{\textsc{Graph Non-Isomorphism}}


\newcommand{\Acc}{\textsc{Acc}}
\newcommand{\Samp}{\textsc{Samp}}
\newcommand{\Ext}{\ensuremath{\text{Ext}}}

\newcommand{\BD}{\mathbb{QB}}
\newcommand{\DD}{\mathbb{D}}
\newcommand{\DDb}{\mathbb{D'}}
\newcommand{\Pot}{\Phi}
\newcommand{\inj}{J}
\newcommand{\mZ}{\mathcal{Z}}
\newcommand{\mN}{\mathcal{N}}
\newcommand{\vs}{\vspace{2mm}~\newline\noindent}
\newcommand{\vb}{\vspace{3mm}\noindent}
\newcommand{\sX}{\mathcal{X}}
\newcommand{\sA}{\mathcal{A}}
\newcommand{\sB}{\mathcal{B}}
\newcommand{\sY}{\mathcal{Y}}
\newcommand{\sR}{\mathcal{R}}


\newcommand{\trnq}[1]{\left[ {#1} \right]_q}

\DeclareMathOperator{\polylog}{polylog}
\newcommand{\mx}[1]{\mathbf{{#1}}}
\newcommand{\vc}[1]{\mathbf{{#1}}}
\newcommand{\abs}[1]{\left\vert {#1} \right\vert}
\newcommand{\norm}[1]{\left\| {#1} \right\|}
\newcommand{\for}{\text{for }}

\DeclareMathOperator{\arcsinh}{arcsinh}
\DeclareMathOperator{\tr}{tr}

\newcommand{\E}{\mathop{\mathbb{E}}\displaylimits} % Expectation

\newcommand{\unif}{\mathcal{U}}
\newcommand{\pt}{\textrm{pt}}
\newcommand{\sample}{\textrm{sample}}
\newcommand{\test}{\textrm{test}}
\newcommand{\free}{\mathcal{F}}
\newcommand{\plane}{\mathcal{P}}
\newcommand{\lines}{\mathcal{L}}
\newcommand{\clines}{\mathcal{CL}}
\newcommand{\pl}{\mathbf{p}}
\newcommand{\individual}{\textrm{individual}}
\newcommand{\blocks}{\textrm{blocks}}
\newcommand{\liness}{\textrm{lines}}
\newcommand{\lp}{\mathcal{LP}}
\newcommand{\Pl}{\ensuremath{\mathrm{Pl}}}
\newcommand{\Ln}{\ensuremath{\mathrm{Lines}}}
\newcommand{\mode}{\mathfrak{m}}
\newcommand{\ECC}{\ensuremath{\textsc{ECC}}}
\newcommand{\EC}{\ensuremath{\textsc{EC}}}
\newcommand{\ENC}{\ensuremath{\textsc{ENC}}}
\newcommand{\cktval}{\ensuremath{\textsc{CKTVAL}}}


\newcommand{\GL}{\mathrm{GL}}
\newcommand{\Matrix}{\mathrm{M}}
\newcommand{\End}{\mathrm{End}}
\newcommand{\Aut}{\mathrm{Aut}}

\newcommand{\game}{\mathfrak{G}}
\newcommand{\sampler}{\mathcal{S}}
\newcommand{\decider}{\mathcal{D}}
\newcommand{\verifier}{\mathcal{V}}


\newcommand{\type}{\mathcal{T}}
\newcommand{\lt}{\mathcal{L}}
\newcommand{\rt}{\mathcal{R}}
\newcommand{\checker}{\mathcal{C}}


\newcommand{\gamestyle}[1]{\ensuremath{\textsc{#1}}\xspace}
\newcommand{\qld}{\gamestyle{QLD}}
\newcommand{\ms}{\gamestyle{MS}}
\newcommand{\pauli}{\gamestyle{Pauli}}
%\newcommand{\bp}{\gamestyle{BP}}
\newcommand{\ora}{\gamestyle{Orac}}
\newcommand{\pcp}{\gamestyle{PCP}}
\newcommand{\ar}{\gamestyle{AR}}
\newcommand{\intro}{\gamestyle{Intro}}

\newcommand{\labelstyle}[1]{\ensuremath{\textsc{#1}}\xspace}
\newcommand{\EPR}{\labelstyle{EPR}}
\newcommand{\aux}{\labelstyle{aux}}
\newcommand{\ancilla}{\labelstyle{anc}}
\newcommand{\msc}{\labelstyle{MC}}
\newcommand{\msv}{\labelstyle{MV}}
\newcommand{\vertex}[1]{\labelstyle{V#1}}
\newcommand{\edge}[1]{\labelstyle{N#1}}
\newcommand{\basis}{\labelstyle{W}}
\newcommand{\xpt}{\labelstyle{X}}
\newcommand{\zpt}{\labelstyle{Z}}
\newcommand{\rxpt}{\labelstyle{R}_\xpt}
\newcommand{\rzpt}{\labelstyle{R}_\zpt}
\newcommand{\dir}[1]{\labelstyle{V#1}}
\newcommand{\coord}{\labelstyle{I}}
\newcommand{\intercept}{\labelstyle{U}}
\newcommand{\plf}{\labelstyle{Pl}}
\newcommand{\lnf}{\labelstyle{Ln}}
\newcommand{\ptf}{\labelstyle{Pt}}
\newcommand{\full}{\labelstyle{full}}
\newcommand{\opt}{\labelstyle{opt}}
\newcommand{\partition}{\mathcal{B}}

\newcommand{\tvarstyle}[1]{\mathsf{#1}}
\newcommand{\tvar}{\ensuremath{\tvarstyle{t}}}
\newcommand{\lvar}{\ensuremath{\tvarstyle{u}}}
\newcommand{\rvar}{\ensuremath{\tvarstyle{v}}}
\newcommand{\pvar}{\ensuremath{\tvarstyle{p}}}
\newcommand{\ovar}{\ensuremath{\tvarstyle{o}}}
\newcommand{\trole}{\ensuremath{v}} % used in intro types

\newcommand{\types}{\labelstyle{T}}

\newcommand{\decode}{\labelstyle{Decode}}

%\newcommand{\alice}{\labelstyle{Alice}}
%\newcommand{\bob}{\labelstyle{Bob}}
\newcommand{\alice}{\labelstyle{A}}
\newcommand{\bob}{\labelstyle{B}}

\newcommand{\oracle}{\labelstyle{Oracle}}
\newcommand{\ab}{\{\alice, \bob\}}

\newcommand{\typestyle}[1]{\ensuremath{\textsc{#1}}\xspace}
\newcommand{\Type}{\typestyle{Type}}
\newcommand{\Plane}{\typestyle{Plane}}
\renewcommand{\line}{\mathbf{\ell}}
\newcommand{\Llane}{\typestyle{Line}}
\newcommand{\Point}{\typestyle{Point}}
\newcommand{\HPoint}{\typestyle{HPoint}}
\newcommand{\Line}{\typestyle{Line}}
\newcommand{\ALine}{\typestyle{ALine}}
\newcommand{\DLine}{\typestyle{DLine}}
\newcommand{\Pair}{\typestyle{Pair}}
\newcommand{\Constraint}{\typestyle{Constraint}}
\newcommand{\Variable}{\typestyle{Variable}}
\newcommand{\Pauli}{\typestyle{Pauli}}
\newcommand{\Sample}{\typestyle{Sample}}
\newcommand{\Read}{\typestyle{Read}}
\newcommand{\MeasureX}{\typestyle{MeasureX}}
\newcommand{\Hide}[1]{\typestyle{Hide}_{#1}}
\newcommand{\HideX}[1]{\typestyle{HideX}_{#1}}
\newcommand{\Target}[1]{\typestyle{Target}_{#1}}
\newcommand{\Oracle}{\typestyle{Oracle}}
\newcommand{\Introspect}{\typestyle{Intro}}
\newcommand{\Intro}{\typestyle{Intro}}
\newcommand{\Simple}{\typestyle{Simple}}
\newcommand{\Eval}{\typestyle{Eval}}
\newcommand{\Agg}{\typestyle{Agg}}
\newcommand{\Input}{\typestyle{Input}}
\newcommand{\Skip}{\typestyle{Skip}}
\newcommand{\Alice}{\typestyle{Alice}}
\newcommand{\Bob}{\typestyle{Bob}}
\newcommand{\Edge}{\typestyle{Alice}}
\newcommand{\Vertex}{\typestyle{Bob}}
\newcommand{\Anchor}{\typestyle{Anchor}}
\renewcommand{\Game}{\typestyle{Game}}
\newcommand{\AB}{\{\alice, \bob\}}
\newcommand{\ctrl}{\labelstyle{c}}
\newcommand{\target}{\labelstyle{t}}

\newcommand{\abc}[1][\delta]{\otimes I_\bob \simeq_{#1} I_\alice \otimes}

\newcommand{\ldc}{k} % number of copies of classical ld tests

\newcommand{\class}[1]{\ensuremath{\mathsf{#1}}\xspace}
\newcommand{\NP}{\class{NP}} %
\newcommand{\IP}{\class{IP}} %
\newcommand{\EXP}{\class{EXP}} %
\newcommand{\NEXP}{\class{NEXP}} %
\newcommand{\QMA}{\class{QMA}} %
\newcommand{\QMIP}{\class{QMIP}} %
\WithSuffix\newcommand\QMIP*{\ensuremath{\class{QMIP}^*}} %
\newcommand{\PSPACE}{\class{PSPACE}} %
\newcommand{\PCP}{\class{PCP}} %
\newcommand{\MIP}{\class{MIP}} %
\newcommand{\MIPco}{\class{MIP}^{\mathrm{co}}} %
\newcommand{\RE}{\class{RE}} %
\newcommand{\coRE}{\class{coRE}}
\newcommand{\NEEXP}{\class{NEEXP}} %
\newcommand{\NEEEXP}{\class{NEEEXP}}
\WithSuffix\newcommand\MIP*{\ensuremath{\class{MIP}^*}} %
\newcommand{\QIP}{\class{QIP}} %


\newcommand{\Ent}{\mathscr{E}}
\newcommand{\compr}{\textsc{Compr}}
\newcommand{\halt}{\textsc{Halt}}
\newcommand{\machine}{\cal{M}}
\renewcommand{\cal}[1]{\mathcal{#1}}
\newcommand{\Kleene}{\cal{K}}
\newcommand{\qldparams}{\mathsf{qldparams}}
\mathchardef\mhyphen="2D
\newcommand{\Fqldparams}{\F_2\mhyphen\mathsf{qldparams}}
\newcommand{\introparams}{\mathsf{introparams}}
\newcommand{\ldparams}{\mathsf{ldparams}}
\newcommand{\tmldparams}{\mathsf{tmldparams}}
\newcommand{\pcpparams}{\mathsf{pcpparams}}

\newcommand{\TMtoSAT}{\mathrm{TMtoSAT}}
\newcommand{\TMtoLD}{\mathrm{TMtoLD}}
\newcommand{\BoundedHalting}{\mathrm{BH}}
\newcommand{\timecomplexity}{\mathsf{TIME}}
\newcommand{\TIME}{\mathsf{TIME}}
\newcommand{\answer}{\mathsf{ANS}}
\newcommand{\MS}{\mathrm{MS}}

\newcommand{\accept}{\typestyle{Accept}}
\newcommand{\reject}{\typestyle{Reject}}

\newcommand{\anch}{\gamestyle{Anch}}
\newcommand{\ans}{\gamestyle{ANS}}
%%%%%%%self testing macros%%%%%%%%%%

\newcommand{\local}{\mathrm{local}}
%\newcommand{\aux}{\mathrm{aux}}


\newcommand{\G}{\mG}
\newcommand{\XZ}{\mathcal{B}}
\newcommand{\hilb}{\mathcal{H}}


%\newcommand{\tmstyle}[1]{\ensuremath{\textsf{#1}}}
\newcommand{\tmstyle}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\Compress}{\tmstyle{Compress}}
\newcommand{\ComputeRepetitions}{\tmstyle{ComputeRepetitions}}
\newcommand{\ComputeSampler}{\tmstyle{ComputeSampler}}
\newcommand{\RawIntroSampler}{\tmstyle{RawIntroSampler}}
\newcommand{\ComputeIntroSampler}{\tmstyle{IntroSampler}}
\newcommand{\RawIntroDecider}{\tmstyle{RawIntroDecider}}
\newcommand{\ComputeIntroDecider}{\tmstyle{IntroDecider}}
\newcommand{\ComputeIntroVerifier}{\tmstyle{IntroVerifier}}
\newcommand{\ComputeOracleVerifier}{\tmstyle{OracleVerifier}}
\newcommand{\ComputeAnsVerifier}{\tmstyle{AnsRedVerifier}}
\newcommand{\ComputeParrepVerifier}{\tmstyle{RepeatedVerifier}}
\newcommand{\ComputePCPVerifier}{\tmstyle{PCPVerifier}}
\newcommand{\ComputeFixedPoint}{\tmstyle{ComputeFixedPoint}}
\newcommand{\detype}{\tmstyle{Detype}}

\newenvironment{gamespec}{
  \begin{mdframed}[style=figstyle]}{
  \end{mdframed}}

\newcommand{\zero}{\mathrm{zero}}

%%%%%%%From NW19:%%%%%%%%%%
\newcommand{\polymeas}[3]{\mathrm{PolyMeas}(#1,#2,#3)}
\newcommand{\simulpolymeas}[4]{\mathrm{PolyMeas}(#1,#2,#3, #4)}

\newcommand{\eval}{\mathrm{eval}}

%\newcommand{\coin}{o}
\newcommand{\succinctdecider}{\ensuremath{\mathsf{SuccinctDecider}}}
\newcommand{\circuit}{\mathcal{C}}
\newcommand{\formula}{\mathcal{F}}
\newcommand{\bin}{\mathrm{binary}}
\newcommand{\pcpeval}{\Xi}
\newcommand{\pcpverifier}{\mathcal{M}_\ar}
\newcommand{\qlen}{Q}
\DeclareMathOperator{\ev}{eval}

\newcommand{\coded}{\mathrm{Dec}}
\newcommand{\hx}{\hat{x}}
\newcommand{\hz}{\hat{z}}
\newcommand{\htvar}{\hat{\tvar}}
\newcommand{\soundness}{\mathrm{sound}}

\newcommand{\rep}{\gamestyle{Rep}}
\newcommand{\sep}{\gamestyle{Sep}}

\newcommand{\binary}[1]{\mathrm{binary}_{#1}}
\newcommand{\num}[1]{\mathrm{number}_{#1}}
\newcommand{\canbasis}[1]{\mathrm{basis}(#1)}
\newcommand{\canH}[3]{H_{\mathrm{canon}, #1, #2, #3}}
\newcommand{\canlilh}[3]{h_{\mathrm{canon}, #1, #2, #3}}
\newcommand{\canin}[3]{\pi_{\mathrm{canon},#1,#2,#3}}
\newcommand{\canenc}[4]{g_{\mathrm{canon},#1,#2,#3,#4}}


% \usepackage{showlabels}
% \renewcommand{\showlabelfont}{\tiny\ttfamily\color{red}}

\bibliographystyle{alpha}

\newif\ifnotes\notestrue
%\newif\ifnotes\notesfalse

\input{marginnotes}
\begin{document}

\title{Qubit tests from classical codes}

\author{}
\date{\today}
\maketitle

\noteswarning


\begin{abstract}

\end{abstract}

	\section{Preliminaries}

\subsection{Algebra}

  A \emph{tracial von Neumann algebra} is a pair $(\mM,\tau)$ of a von Neumann algebra $\mM$ together with a normal faithful tracial state $\tau$ on $\mM$, which we often refer to as the \emph{trace}. The main example of interest is $\mM=M_n(\C)$, the algebra $n\times n$ complex matrices, with $\tau$ the dimension-normalized trace, which we denote $\tr(M)=\frac{1}{d}\Tr(M)$. 	We write $\|x\|_2=\tau(x^*x)^{1/2}$ for the $2$-norm on $\mM$.
	
	We denote $\mM_\infty = \mM \overline{\otimes} B(\ell_2)$ with (infinite) trace $\tau_\infty = \tau \otimes \Tr$. We identify $\mM$ with $\mM\otimes e_{1,1}\subset \mM_\infty$. 

	We let $\field$ denote the field with two elements. For $u\in \F^n$ for some $n$, we write $|u|$ for the Hamming weight of $u$, i.e.\ the number of nonzero coordinates. 
	
	
	\subsection{Measurements}
	
	A POVM on $\mM$ is a finite collection of positive semidefinite operators $\{P_i\}_{i\in \mI}$ such that $\sum_i P_i = 1_\mM$. A POVM is \emph{projective} if for all $i$, $P_i$ is a projection. 
	
	Given a projective measurement $\{P_a\}_{a\in \field^k}$ and $b\in \field^k$ we let $\widehat{P}(b) = \sum_a (-1)^{a\cdot b} P_a$ be the associated observable. If $k=1$, we often use the shorthand $\widehat{P}$ for $\widehat{P}(1) = P_0-P_1$.
	
	\begin{definition}[Closeness]\label{def:close}
Let $\{A^i_a\}\subseteq \mM$ and $\{B^i_b\}\subseteq \mN$ be two families of projective measurements on  tracial algebras $(\mM,\tau^\mM)$ and $(\mN,\tau^\mN)$ respectively, and indexed by the same set $i\in \mI$. For $\delta\geq0$ and $\mu$ a measure on $\mI$ we say that $\{A^i\}$ and $\{B^i\}$ are $(\delta,\mu)$-close if there exists a projection $P\in\mM_\infty$ of finite trace such that $\mN=P\mM_\infty P$ and $\tau^\mN=\tau^\mM/\tau^\mM_\infty(P)$, and a partial isometry $w\in P \mM_\infty 1_\mM$ such that 
\[ \Es{i\sim\mu} \sum_a \big\| A^i_a - w^* B^i_a w \big\|_2^2 \,\leq\,\delta\]
and 
\[\max\big\{ \tau^\mM(1-w^*w)\,,\; \tau^\mN(P-ww^*)\big\} \,\leq\, \delta\;.\]
If the measure $\mu$ is omitted then it is the uniform measure on $\mI$.
\end{definition}
	
\begin{lemma}\label{lem:pull-back}
Let  $(\mM,\tau^\mM)$ be a tracial von Neumann algebra, $P\in\mM_\infty$ a projection of finite trace, $\mN=P\mM_\infty P$ and $\tau^\mN=\tau^\mM/\tau^\mM_\infty(P)$, and $w\in P \mM_\infty 1_\mM$ a partial isometry. Let 
\[ \eps = 1-\min\big\{ \tau^\mM\big(1_\mM - w^* w\big)\,,\;\tau^\mN\big( P- w w^*\big)\big\}\;.\]
 Then for any projective measurement $\{P_i\}$ on $\mN$, there is a projective measurement $\{Q_i\}$ on $\mM$ such that 
\[ \sum_i \big\| Q_i - w^* P_i w\big\|_2^2 \,=\, O(\eps)\;.\] 
\end{lemma}	

\begin{proof}
If $\eps\geq \frac{1}{2}$ the conclusion is trivial (for a suitably large implicit constant), so assume $\eps<\frac{1}{2}$. 
Define 
\[\tilde{Q}_i = w^* P_i w  + \frac{1}{|\mI|}\big(1_\mM - w^* w\big) \in \mM\;.\]
Then $\{\tilde{Q}_i\}$ is an incomplete POVM. Moreover, 
\begin{align*}
\sum_{i} \tau\big( (\tilde{Q}_i)^2 \big) &\geq \sum_{i} \tau\big( \big(w^* P_i w \big)^2 \big) \\
&= \sum_{i} \tau\big(  w^* P_i w w^*P_i w \big)\\
&= \sum_i \tau\big(  w^* P_i  P P_i w \big) - \sum_i \tau_\infty\big( w^* P_i  ( P - w w^*) P_i w \big)\\
&\geq 1 - \eps -  2\tau_\infty\big( P- w w^*\big)\;,
\end{align*}
where the last inequality uses that $\sum_i P_i = \Id_\mN$ and $\|ww^*\|,\|P\|_\infty\leq 1$. By assumption, 
\begin{align*}
\tau_\infty\big( P- w w^*\big) \,\leq\, \eps \tau_\infty(P)\,\leq \frac{\eps}{1-\eps}\;.
\end{align*}
where the last inequality is because by definition, $\tau^N(P)=1$, thus
\[1-\eps \,\leq\, \tau^\mN(ww^*) \,=\, \frac{\tau_\infty(ww^*)}{\tau_\infty(P)} \,\leq\, \frac{1}{\tau_\infty(P)}\]
Overall, 
\[ \sum_{i} \tau\big( (\tilde{Q}_i)^2 \big) \,\leq\, 1-\eps-\frac{2\eps}{1-\eps}\,\leq\, 1-5\eps\;.\]
Therefore we can apply~\cite[Theorem 1.2]{de2021orthogonalization} to obtain a projective measurement $\{Q_i\}$ on $\mM$ such that 
\begin{equation*}
\sum_i \big\|{Q}_i - \tilde{Q}_i \big\|^2_2 \,=\, O(\eps)\;.
\end{equation*}
Finally,
\begin{align*}
\sum_i \big\|{Q}_i - w^*{P}_i w\big\|^2_2 &= \sum_i \big\|{Q}_i - \tilde{Q}_i  + \frac{1}{|\mI|}\big(1_\mM - w^* w\big) \big\|^2_2\\
&\leq  \sum_i \big\|{Q}_i - \tilde{Q}_i\big\|_2^2  + 2\tau\big(1_\mM - w^* w\big) \\
&=  O(\eps)\;.
\end{align*}
\end{proof}
	
	
\section{Quantum soundness of linear codes}

\subsection{Classical definitions}

\begin{definition}[Code]
A $[n,k,d]$ linear code is a $k$-dimensional subspace $\code\subseteq \field^n$ such that for every $u\in \code$ such that $u\neq 0$, $|u|\geq d$. Equivalently, we think of $\code$ as a linear map $\code:\field^k\to \field^n$. We write $G_\code \in \field^{k\times n}$ for the generator matrix defined by $ G_\code^T e_i =\code(e_i)$ for all $i\in\{1,\ldots,k\}$, where $\{e_1,\ldots,e_k\}$ is the standard basis of $\field^k$. 
\end{definition}

%\begin{definition}
%Let $\code$ be an $[n,k,d]_q$ linear code. Define $\ind:\{1,\ldots,n\}\to \field^k$ such that for every $a\in \field^k$ and $i\in\{1,\ldots,n\}$, $a\cdot \ind(i) = \code(a)_i$.
%\end{definition}

\begin{definition}[Oracle machine]
A (non-adaptive) \emph{randomized oracle machine} $M$ is a Turing machine that has read access to two special tapes, the randomness tape and the proof tape. $M$ operates in two stages. In the first stage, $M$ accesses the randomness tape in state $\rand$ and returns a set $S=M(\rand)\subseteq\{1,\ldots,n\}$ of  indices of the proof tape. In the second stage $M$ reads the corresponding entries from the state $\pi$ of the proof tape and returns a value in $\{0,1\}$, which only depends on $S$ and $\pi_S$, not on $\rand$. We write $M(\rand,\pi)$ for the decisions taken by $M$ when the randomness tape is $\rand$ and the proof tape is $\pi$. We also write $M(S,\pi_S)\in\{0,1\}$ for the decision taken by $M$ when the chosen entries are $S$ and their values is $\pi_S$.   
\end{definition}

\begin{definition}[Codeword test]
Let $\code$ be an $[n,k,d]$ linear code, $\delta:[0,1]\to[0,1]$, and $r\in \N$.
A $r$-local $\delta$-tester for $\code$ is a non-adaptive randomized oracle machine $M$ that makes at most $r$ queries to its proof tape and satisfies the following conditions:
\begin{itemize} 
\item (Completeness:) For any $u\in \code$, $\Pr_\rand( M(\rand,u)=1)=1$.
\item (Soundness:) For any $\eps\geq 0$ and any $u\in \field^n$ that is within (Hamming) distance at least  $\eps$ from $\code$, $\Pr_\rand(M(\rand,u)=0)\geq \delta(\eps)$. 
\end{itemize}
\end{definition}

%\begin{definition}[Local quantum presentation]
%Let $\code$ be an $[n,k,d]_q$ linear code and $r\in \N$. An \emph{$r$-local quantum presentation of $\code$} is specified by
%\begin{itemize}
%\item A tracial von Neumann algebra $(\mM,\tau)$;
%\item For each $i\in\{1,\ldots,n\}$, a $q$-outcome projective measurement $\{A^i_a\}_{a\in \field} \subseteq \mM$;
%\item For each $S\subseteq \{1,\ldots,n\}$ such that $|S|\leq r$, a projective measurement $\{P^S_a\}_{a\in \field^S}\subseteq \mM$.
%\end{itemize}
%\end{definition}

\subsection{Quantum soundness}

\begin{definition}[Code representation]
Let $\code$ be an $[n,k,d]$ linear code. A \emph{representation} of $\code$ is a collection of projective measurements $\{A^i_a\}_{a\in\field} \subseteq\mM$ for $i\in\{1,\ldots,n\}$ such that the $\{A^i_a\}$ pairwise commute and $\sum_{c\in\code} \prod_{i=1}^n A^i_{c_i}=\Id$.\footnote{This implies that whenever $u\notin \code$, $\prod_i A^i_{u_i}=0$.} 
\end{definition}



\begin{definition}[$\eps$-local presentation]
Let $\code$ be an $[n,k,d]$ linear code and $M$ an $r$-local tester for $\code$. An \emph{$\eps$-local presentation of $(\code,M)$} is a collection of projective measurements $\{A^i_a\}_{a\in\field} \subseteq\mM$ for $i\in\{1,\ldots,n\}$ such that for any $S\subseteq\{1,\ldots,n\}$ of size $|S|\leq r$ there are $S$ pairwise commuting projective measurements $\{B^{S,i}_a\}_{i\in S}$ and $\eps_S\geq 0$ such that 
\begin{itemize}
\item $\sum_{a\in \F^S} 1_{M(S,a)=1} \prod_{i\in S} B^{S,i}_{a_i}= \Id$
\item $\{A^i\}_{i\in S}$ and $\{B^{S,i}\}_{i\in S}$ are $\eps_S$-close
\end{itemize} 
and moreover $\Es{S\leftarrow M(\cdot)} \eps_S \leq \eps$. 
\end{definition}


\begin{definition}[Quantum soundness]\label{def:q-sound}
Let $\code$ be an $[n,k,d]_q$ linear code and $M$ a $r$-local tester for $\code$. Let $\delta:[0,1]\to[0,1]$ be such that $\delta(0)=0$. We say that $M$ has \emph{quantum soundness $\delta(\eps)$} if the following holds. For any $\eps$-local presentation $(\mM,A)$ of $(\code,M)$
% such that 
%\[ \Es{S\leftarrow M(\cdot)} \Es{i\in S} \sum_{a\in \field^s} \big[ \tau\big(  P^S_a  A^i_{a_i}\big) \big] \,\geq \,1-\eps\;,\] 
there is a representation $(\mN,B)$ of $\code$ such that $(\mM,A)$ and $(\mN,B)$ are $\delta(\eps)$-close. 
\end{definition}

Definition~\ref{def:q-sound} can be reformulated in the language of nonlocal games, see Proposition~\ref{prop:sound-game}. 

\begin{remark}
A necessary condition for a code to be quantum sound is that any $0$-local quantum presentation $(\mM,A)$ is  a representation of $\mC$. Not all codes satisfy this condition, see e.g.~\cite[Example 2.16]{paddock2022arkhipov}. If $(\mC,M)$ satisfies this condition, then we say that it is \emph{Abelian}. Thus, Abelian codes have, by definition, quantum soundness $\overline{\delta}$ where $\overline{\delta}(0)=0$ and $\overline{\delta}(x)=1$ for $x\in(0,1]$. 
\end{remark}


		
		
\subsection{Example: the Hadamard code}

We give an example of a family of quantum sound codes, the \emph{Hadamard codes}. This code can be defined for any  $k\geq 1$ and it is an $[K,k,K/2]_2$ linear code, for $K=2^k$. For simplicity we write  $\code_\had$ for it, omitting $k$. As a linear map, for $i\in\{1,\ldots,k\}$, $\code_\had(e_i) = (x_i)_{x\in \field^k} \in \field^K$, where we identify the index set $\{1,\ldots,K\}$ with the set $\field^k$ in an arbitrary way.  

It is shown in~\cite{blum1990self} that the following randomized oracle machine $M_\had$ is a $3$-local $\delta$-tester for $\code_\had$, where $\delta(\eps)=6\eps$. $M$ first uses its random tape to select $x,y\in\field^k$uniformly at random and returns the set $S=\{x,y,x+y\}$. For $\pi\in \field^K$, $M(S,\pi_S)$ accepts if and only if $\pi_x + \pi_y  = \pi_{x+y}$. 

Using~\cite[Theorem 10]{natarajan2016robust} it follows that $M$ has quantum soundness $O(\eps)$.\footnote{While~\cite{natarajan2016robust} only show the result for finite-dimensional $\mM$, the same proof works for any $(\mM,\tau)$.}

%\subsection{Tensor codes}
%
%Fix a $t_0$-interpolable $[n_0,k_0,d_0]_q$ code $\code_0$, and $m\in \N$. Let $\code = \code_0^{\otimes m}$. Then $\code$ is an $[n,k,d]_q$ code where $n=n_0^m$, $k=k_0^m$ and $d=d_0^m$. 
%
%
%If $\code_0$ is a Reed-Solomon code with degree $s_0=t_0-1$, then $n_0=q$ and $d_0=n_0-s_0=n_0-t_0+1$.


\section{Nonlocal games}

\begin{definition}[Game]
A game is a tuple $(\mX,\mu,\mA,D)$ where $\mX$ is a finite set, $\mu$ a distribution on $\mX\times \mX$, $\mA=(\mA(x))_{x\in\mX}$ a collection of finite sets, and 
\[ D: \big\{ (x,y,a,b) : (x,y)\in\text{supp}(\mu),a\in\mA(x),b\in\mA(y)\big\} \;\to\;\{0,1\}\]
such that $D$ is symmetric, i.e. $D(x,y,a,b)=D(y,x,b,a)$ whenever both terms are defined. We often abuse notation and write $\mu$ for the symmetrized marginal of $\mu$, i.e.\ 
\[\mu(x) := \sum_{x'\in \mX} \frac{1}{2}\big(\mu(x,x')+\mu(x',x')\big)\;.\]
\end{definition}
		
\begin{definition}[Synchronous strategy]
If $G=(\mX,\mu,\mA,D)$ is a game and $(\mM,\tau)$ a tracial von Neumann algebra, a \emph{synchronous strategy $\strategy$ for $G$ on $(\mM,\tau)$} is, for every $x\in \mX$, a projective measurement $(P^x_a)_{a\in \mA(x)}$ on $\mM$. The value of a strategy $\strategy$ in $G$ is 
\[ \omega(G;\strategy)\,=\, \sum_{(x,y)\in\mX\times\mX}\frac{1}{2}\big(\mu(x,y)+\mu(y,x)\big) \sum_{(a,b)\in\mA(x)\times\mA(y)} D(x,y,a,b)\, \tau\big(P^x_a \,P^y_b\big) \;.\footnote{Note the symmetrization of $\mu$. This is to avoid explicitly requiring $\mu$ to be permutation-invariant in the definition of a game.}\]
We say that $\strategy$ is \emph{perfect} if $\omega(G;\strategy)=1$.
\end{definition}

\begin{definition}[Robust game]
Given a game $G$ and a function $\delta:[0,1]\to[0,1]$ we say that $G$ is \emph{$\delta$-robust} if any synchronous strategy for $G$ that succeeds with probability at least $1-\eps$ in $G$, for some $\eps\geq 0$, is $(\delta(\eps),\mu)$-close to a perfect strategy.
\end{definition}

Let $\code$ be an $[n,k,d]$ linear code and $M$ an $r$-local tester for $\code$. Consider the following game $G_{\code,M}$. We set 
\[\mX = \{ S\subseteq \{1,\ldots,n\},|S|\leq r\} \sqcup\{1,\ldots,n\}\quad\text{and}\quad \mu(S,i)=\frac{1_{i\in S}}{|S|}\Pr_\rand\big(M(\rand)=S\big)\;,\]
and for any $S,i\in\mX$, $\mA(S)=\field^S$ and $\mA(i)=\field$, and $D(S,i,a,b)=M(S,a)1_{a_i=b}$. 

\tnote{The next proposition sounds like a special case of some other lemma about LCS games, which is probably written somewhere}

\begin{proposition}\label{prop:sound-game}
Let $\code$ be an $[n,k,d]$ linear code and $M$ an $r$-local tester for $\code$. Let $\delta,\delta':[0,1]\to[0,1]$. Then the following hold:
\begin{enumerate}
\item If $M$ has quantum soundness $\delta$ then $G_{\code,M}$ is $O(\delta)$-robust.
\item If $G_{\code,M}$ is $\delta'$-robust and $(\mC,M)$ is Abelian then $M$ has quantum soundness $O(r\delta')$. 
\end{enumerate}
\end{proposition}

\begin{proof}[Proof sketch]
We start with the second assertion. Suppose then that that $G_{\code,M}$ is $\delta'$-robust, for some function $\delta'$. Let $(\mM,A)$ be be an $r$-local $\eps$-presentation of $\code$, and for each $S\subseteq\{1,\ldots,n\}$ such that $|S|=r$, $\{B^{S,i}\}_{i\in S}$ the commuting family of projective measurements promised by the definition; then there is an isometry $w$ such that 
\[ \Es{i\in S} \sum_a \big\| A^i_a - w^* B^{S,i}_{a}w \big\|_2^2 \,\leq\,\eps_S\;.\]
 For any $a\in\field^S$ let $\tilde{P}^S_a = \prod_{i\in S} B^{S,i}_{a_i}$. Then $\{\tilde{P}^S_a\}_{a\in\field^S}$ is a projective measurement such that
\begin{align}
\Es{S\leftarrow M(\cdot)} \Es{i\in S} \sum_{a\in \field^S} \tau\big(  w^* \tilde{P}^S_a w \, A^i_{a_i}\big) 
&= \Es{S\leftarrow M(\cdot)} \Es{i\in S} \sum_{b\in \field}\tau\big(  w^* B^{S,i}_b w\, A^i_{b}\big)\notag \\
&= \Es{S\leftarrow M(\cdot)} \Es{i\in S} \frac{1}{2}\big(\tau(w^*w) + \tau(1) - \sum_{b\in \field} \big\|  w^* B^{S,i}_b w - A^i_{b}\big\|_2^2\big) \notag\\
&\geq \,1-2\eps\;.\label{eq:s-g-1}
\end{align}
Let $\{P^S_a\}$ be the family of projective measurements on $\mM$ that is promised by Lemma~\ref{lem:pull-back}. It follows that  
\begin{align}
\Es{S\leftarrow M(\cdot)} &\Es{i\in S} \sum_{b\in\field}\big\| \sum_{\substack{a\in \field^S\\a_i=b} } P^S_a - A^i_{a_i}\big\|_2^2\notag\\ 
&\leq 2\Es{S\leftarrow M(\cdot)} \Es{i\in S}\sum_{b\in\field}\big\| \sum_{\substack{a\in \field^S\\a_i=b} } w^*\tilde{P}^S_a w- A^i_{a_i}\big\|_2^2
+ 2\Es{S\leftarrow M(\cdot)} \Es{i\in S} \sum_{b\in\field}\big\| \sum_{\substack{a\in \field^S\\a_i=b} } w^*\tilde{P}^S_a w - \sum_{\substack{a\in \field^S\\a_i=b} } {P}^S_a\big\|_2^2 \notag\\
&= O(\eps)\;,\label{eq:s-g-2}
\end{align}
where in the last line the first term is bounded by~\eqref{eq:s-g-1} and the second using the guarantees of Lemma~\ref{lem:pull-back}.
Using the definition of $G_{\code,M}$,~\eqref{eq:s-g-2} can be rewritten as
\begin{equation}
 \sum_{(S,i)} \mu(S,i) \sum_{a\in \field^s}\sum_{b\in\field} D(S,i,a,b) \tau\big(  P^S_a  A^i_{b}\big) \,\geq \,1-O(\eps)\;.\label{eq:s-g-2}
\end{equation}
In other words $\omega(G_{\code,M};\strategy)\geq 1-\eps'$ for $\strategy$ the strategy with measurements $\{A^i_b\}$ and $\{P^{S}_a\}$ and some $\eps'=O(\eps)$. Using the definition of robustness we deduce that $(\mM,A,P)$ is $(\delta'(\eps'),\mu)$-close to a perfect strategy $(\mN,C,Q)$ for $G$. Specializing to the $A$ measurements, using the definition of closeness there exists a projection $P\in \mM_\infty$ and $\{C^i\}_a \subseteq P\mM_\infty P$ such that $\Es{i}\sum_a \|A^i_a-w^* C^i_a w \|_2^2 \leq 2\delta'$, and moreover $\{C^i_a\}$ satisfy that for any $S$ in the support of $\mu$, $\{C^i_a\}$ pairwise commute for $i\in S$. Using the assumption that $(\code,M)$ is Abelian, all the $\{C^i_a\}$ commute and form a representation of $\code$.

Now we show the first assertion. Suppose that $M$ has quantum soundness $\delta$.
Let $\strategy=(\mM,A,P)$ be a strategy for $G_{\code,M}$ on $(\mM,\tau)$ that succeeds with probability at least $1-\eps$. Using similar reasoning as above, $(\mM,A)$ is an $\eps'$-local presentation of code, for some $\eps'=O(\eps)$. Using quantum soundness, there is a representation $(\mN,B)$ that is $\delta'$-close, for $\delta'=\delta(\eps')$. Now, we let $Q^S_a = \prod_{i\in S} B^i_{a_i}$ which is a projective measurement on $\mN$. It is easy to verify that $(\mN,B,Q)$ is a perfect strategy in $G_{\code,M}$. Moreover $(\mN,B,Q)$ is $O(r\delta)$-close to $(\mM,A,P)$.\tnote{This last estimate is a guess and needs a calculation}
\end{proof}


\subsection{Commutation game}

See~\cite[Section 3.1]{de2022spectral}. We denote $x_{X,0}, x_{Z,0} \in \mX_{com}$ the two special questions, $x_{com,1}$ and $x_{com,2}$ respectively. 

\subsection{Anti-commutation game}

See~\cite[Section 3.2]{de2022spectral}. We denote $x_{X,1}, x_{Z,1} \in \mX_{anticom}$ the two special questions, $x_{anticom,1}$ and $x_{anticom,2}$ respectively. 

\subsection{Combined game}

Let $\code$ be an $[n,k,d]$ linear code and $M$ an $r$-local tester for $\code$. 
We use $G_{\dlS}$ to denote the game introduced in~\cite[Section 3.4]{de2022spectral}, specialized to the following choices. The group is $H=\field^k$. Let
\[ S_X=S_Z=\{G_\code e_i:\,i\in\{1,\ldots,n\}\}\subseteq \field^k\,\]
let $\mu_{\dlS}$ be the uniform distribution over $S_X\times S_Z$. Let $\Omega$ be the support of $\mu_{\dlS}$ and $\alpha,\beta$ the coordinate projections. Then $G_{\dlS}=(\mX,\mu_{\dlS},\mA,D)$ has question set $\mX = \{PX,PZ\} \cup (\mX_{com}\times \Omega_+) \cup (\mX_{anticom} \times \Omega_-)$. 


\section{Main result}

Let $\code$ be an $[n,k,d]$ linear code and $M$ an $r$-local tester for $\code$. 


\begin{figure}[!htbp]
  \centering
  \begin{gamespec}
Let $M$ be an $r$-local tester for the $[n,k,d]_q$ code $\code$. 
    \begin{enumerate}
      \setlength\itemsep{1pt}
    \item (\textbf{Code test}) Select $W\in \{X,Z\}$ uniformly at random, and $\rand$ a setting for $M$'s random tape at random. Let $S=M(\rand)\subseteq\{1,\ldots,n\}$. Sample $i\in S$ uniformly at random. Send $(W,S)$ to $\alice$ and $(W,i)$ to $\bob$. Receive $a\in \field^S$ from $\alice$ and $b\in \field$ from $\bob$. Accept if and only if $M(S,a)=1$ and $a_i = b$.  
    \item (\textbf{Anti-commutation test}) Select $(i_X,i_Z)\in \{1,\ldots,n\}^2 $ uniformly at random. Let $\omega = (G_\code i_X, G_\code i_Z)$ and $\gamma =  (G_\code i_X) \cdot(G_\code {i_Z}) \in \field$.
		\begin{enumerate}
		\item If $\gamma=0$ then select a pair of questions $(x_c,y_c)$ as in the commutation game. Send $(x_c,\omega)$ to $\alice$ and $(y_c,\omega)$ to Bob. Accept if and only if their answers are accepted in the commutation game. 
		\item If $\gamma\neq 0$ then do the same but for the anti-commutation game. 
		\end{enumerate} 
		 \item (\textbf{Consistency test}) Select $\omega=(i_X,i_Z)\in \{1,\ldots,n\}^2 $ and $W\in \{X,Z\}$ uniformly at random. Let $\gamma = (G_\code i_X) \cdot(G_\code {i_Z}) \in \field$. Send $(W,i_W)$ to $\alice$ and $(x_{W,\gamma},\omega)$ to $\bob$. Receive $a\in \field$ and $b\in \field$ respectively. Accept if and only if $a=b$. 
    \end{enumerate}
  \end{gamespec}
  \caption{The braiding test over $\code$ verifies that the players respond consistently with a uniformly random codeword from $\code$, obtained by measuring $k$ shared EPR pairs in the standard or Hadamard basis and encoding the resulting $k$-bit string.}
  \label{fig:braiding-test}
\end{figure}


\begin{definition}
Let $k\in \N$ and $\delta:[0,1]\to\R_+$. 
A $(k,\delta(\eps))$-qubit test is a synchronous game $G=(\mX,\mu,\mA,D)$ such there are two sets $S_X,S_Z\subseteq \field^k$ and an injection $\phi:(\{X\}\times S_Z) \cup (\{Z\}\times S_Z) \to \mX$ such that $\mA(\phi({X},a))=\mA(\phi({Z},b))=\field$ for all $a\in S_X$, $b\in S_Z$ and such that the following holds:
\begin{itemize}
\item (Completeness:) There is a synchronous strategy for $G$ on $\mM=M_{2^{k}}(\C)$ that succeeds with probability $1$ in $G$ and is such that $\widehat{P^{\phi({W},a)}} = \tau^W(a)$ for every $W\in\{X,Z\}$ and $a\in S_W$.
\item (Soundness:) Any synchronous strategy in $(\mM,\tau)$ for $G$ that succeeds with probability $1-\eps$ for some $\eps\geq 0$ is $\delta(\eps)$-close to a strategy on an algebra of the form $(M_{2^{k}}(\C)\otimes \mN,\tr\otimes \tau')$ and such that
\[\widehat{P^{\phi({W},a)}} = \tau^W(a)\otimes \Id_\mN\;.\]
\end{itemize}
\end{definition}

\begin{remark}
The definition allows ``trivial'' settings for the sets $S_X,S_Z$, e.g.\ $S_X=S_Z=\emptyset$. In this case, a strategy for $G$ may not give direct access (through specific questions) to any Pauli observable and the soundness condition is trivial. As soon as e.g. $S_X,S_Z$ both contain the basis elements $e_1,\ldots,e_k \in \field^k$ then the definition is non-trivial. Moreover, the notion of closeness provided by the soundness statement is averaged over the marginal of the game distribution $\mu$. Therefore, the measurements associated with questions in the range of $\phi$ are close to the ideal measurements only inasmuch the corresponding questions have non-trivial probability of being asked in $G$. 
\end{remark}

\begin{theorem}
Let $\code$ be an $[n,k,d]$ linear code and $M$ an $r$-local tester for $\code$ that is $\delta(\eps)$-quantum sound. Then the braiding test over $\code$ is a $(k,\delta')$-qubit test, where $S_X=S_Z=\{G_\code e_i:\,i\in\{1,\ldots,n\}\}\subseteq \field^k$, $\phi(W,G_\code e_i)=(W,i)$ and $\delta' = O(\delta(6\eps))$.\footnote{Assume $G_\code$ has no repeated columns.} 
\end{theorem}

\begin{proof}
\underline{Completeness:} We first verify completeness. For $W\in\{X,Z\}$ and $i\in\{1,\ldots,n\}$ let $P^{(W,i)}_a = (\tau^W(G_\code e_i))_a$ and $P^{(W,S)}_a = \prod_{i\in S} P^{(W,i)}_{a_i}$. For $\omega=(i_X,i_Z)\in \{1,\ldots,n\}^2 \times \field^2$ and $\gamma =(G_\code i_X) \cdot(G_\code {i_Z}) $ we let $P^{x_{W,\gamma},\omega} = P^{(W,i_W)}$. 

These choices already ensure that the strategy succeeds with probability $1$ in the consistency test. We verify that it succeeds in the code test. Let $S\subseteq\{1,\ldots,n\}$ and $h\in \F_2^S$ any valid parity check for $\code$ with support in $S$. Then $\sum_{i\in S} h_i G_\code e_i = 0$, so $\prod_{i\in S}(\tau^W(G_\code e_i))^{h_i}=\Id$. This means that for any $a\in\field^S$ such that $P^{W,S}_a\neq 0$, we have that $h\cdot a =0$, i.e.\ $a$ satisfies the parity check. Using the completeness property of $M$ it follows that $M$ must accept any $a$ in the support of $P^{W,S}$, which shows that the strategy succeeds in the code test with probability $1$. 

Remains the anti-commutation test. For this we observe that 
% To define $P^{(x_c,\omega)}$ and $P^{(x_a,\omega)}$ for $x_c\notin \{x_{Z,0},x_{Z,0}\}$ and $x_a \notin \{x_{X,1},x_{Z,1}\}$ we observe that 
the binary observables 
\[ U=\widehat{ P^{x_{X,\gamma},\omega}} \quad\text{and}\quad V= \widehat{P^{x_{Z,\gamma},\omega} } \]
commute in case $\gamma=0$ and anti-commute in case $\gamma=1$. This is because by definition $U=\tau^X(G_\code i_X)$ and $V=\tau^W(G_\code i_W)$, and the definition of $\gamma$. Hence the pair $(U,V)$ can be completed to a perfect strategy for the commutation game (if $\gamma=0)$ or anti-commutation game (if $\gamma=1)$. This defines the measurements $P^{(x,\omega)}$ for $x\notin \{x_{W,\gamma},W\in\{X,Z\},\gamma\in\{0,1\}\}$. 

\bigskip 

\underline{Soundness:} Next we show soundness. Let $\strategy$ be a synchronous strategy for $G$  in  $(\mM,\tau)$ that succeeds with probability at least $1-\eps$. For $W\in\{X,Z\}$ let $\strategy^W$ be the strategy in $G_{\code,M}$ that is obtained by restricting $\strategy$ to the relevant measurements, i.e.\ the $P^{W,S}$ and $P^{W,i}$.  Then $\strategy^W$ succeeds with probability at least $1-6\eps$ in $G_{\code,M}$. Using the assumption that $M$ is $\delta(\cdot)$-quantum sound and Lemma~\ref{lem:sound-game} it follows that there is a $\delta_1 = O(\delta(6\eps))$ such that for each $W\in\{X,Z\}$, $\strategy^W$ is $(\delta_1,\mu)$ close to a perfect strategy $\tilde{\strategy}^W$ on $(\mN^W,\tau^W)$. Since $(\code,M)$ is abelian, any perfect strategy comes from a POVM $\{\tilde{P}^W_u\}_{u\in \field^n}$ such that $\sum_{u\in \code}\tilde{P}^W_u = \Id$. 
Applying Lemma~\ref{lem:pull-back}, we obtain projective measurement $\{Q^W_u\}$ on $\mM$ such that 
\begin{equation*}
\sum_u \big\|Q^W_u - (w^W)^* \tilde{P}_u^W w^W \big\|^2_2 \,=\, O(\delta_1)\;.
\end{equation*}
Let $Q^{W,i}_b = \sum_{a: a_i=b} Q^W_u$. 
Using the triangle inequality it then follows that
\begin{equation*}
 \Es{i\in [n]}  \big\|\widehat{\tilde{P}^{W,i}} - \widehat{Q^W}(a) \big\|^2_\tau \,=\, O(\delta_1)\;.
\end{equation*}
In particular, the strategy that consists of $Q^X$, $Q^Z$, $P^{x_c,\omega}$ for $(x_c,\omega) \in \mX_{com}\times \Omega_+$ and $P^{x_{ac},\omega}$ for $(x_{ac},\omega)\in \mX_{anticom} \times \Omega_-$ succeeds in the dlS game with probability $1-O(\delta_1+\eps)$. Applying~\cite[Corollary 3.9]{de2022spectral}, the conclusion follows. 
\end{proof}


\section{Application: the Pauli braiding test}

\subsection{Finite fields}

For $q=2^t$ and $a\in \field$ we let $\kappa(a)$ denote the binary representation of $a$, where the representation is taken in a self-dual normal basis of $\field$ over $\F_2$. We extend $\kappa$ to vectors over $\field$ coordinate-wise.
	
	We use $\tau^W(a)$, $a\in F_q^k$, to denote the tensor product of $k$ Pauli $W$ observables over $\field$. We use $\tau^W_a$ to denote the associated projective measurement. 
	

\bibliography{qld}

\notesendofpaper

\end{document}
