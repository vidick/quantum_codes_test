\documentclass[11pt]{article}
\usepackage{booktabs}
\usepackage{fullpage}
\usepackage{titlesec}
%\newcommand{\sectionbreak}{\clearpage}
\usepackage{amsmath,amsfonts,amsthm,mathrsfs,xspace,graphicx}
\usepackage[backref,colorlinks,citecolor=blue,bookmarks=true]{hyperref}
\usepackage{mathpazo}
\usepackage{endnotes}
\usepackage{color}
\usepackage{float}
\usepackage{xcolor}
\usepackage{mdframed}
\usepackage{bbm}
\usepackage{suffix} % for *-version commands
\usepackage{times}
\usepackage{tabularx}
\usepackage{makecell}
\usepackage{amssymb,latexsym}
%\usepackage{IEEEtrantools}
\usepackage[capitalize]{cleveref}
\usepackage{enumitem}
\usepackage{tikz}
\usepackage{tikz-cd}
\usepackage{multirow}
\usepackage[section]{placeins}
\usepackage[affil-it]{authblk}


\mdfdefinestyle{figstyle}{ %
  linecolor=black!7, %
  backgroundcolor=black!7, %
  innertopmargin=10pt, %
  innerleftmargin=25pt, %
  innerrightmargin=25pt, %
  innerbottommargin=10pt %
}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{fact}[theorem]{Fact}
\newtheorem{corollary}[theorem]{Corollary}

\newtheorem{remark}[theorem]{Remark}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}

\newcommand{\beq}{\begin{eqnarray}}
\newcommand{\eeq}{\end{eqnarray}}

\newcommand{\code}{\mathscr{C}}
\newcommand{\strategy}{\mathscr{S}}
\newcommand{\algebra}{\mathscr{A}}

\newcommand{\ket}[1]{|#1\rangle}
\newcommand{\bra}[1]{\langle#1|}
\newcommand{\ketbra}[2]{\ket{#1}\!\bra{#2}}
\newcommand{\ip}[2]{\langle #1 \! | #2 \rangle}
\newcommand{\proj}[1]{\ket{#1}\!\bra{#1}}
\newcommand{\Tr}{\mbox{\rm Tr}}
\newcommand{\Id}{\ensuremath{I}}
\DeclareMathOperator*{\Expectation}{\mathbb{E}}
\newcommand{\Es}[1]{\Expectation_{#1}}

\newcommand{\reg}[1]{{\textsf{#1}}}
\newcommand{\ol}[1]{\overline{#1}}

\newcommand{\field}{\mathbb{F}_2}
\newcommand{\C}{\ensuremath{\mathbb{C}}}
\newcommand{\N}{\ensuremath{\mathbb{N}}}
\newcommand{\bbN}{\ensuremath{\mathbb{N}}}
\newcommand{\complex}{\ensuremath{\mathbb{C}}}
\newcommand{\real}{\ensuremath{\mathbb{R}}}
%\newcommand{\natural}{\ensuremath{\mathbb{N}}}

\newcommand{\bij}{\pi}
\newcommand{\qp}{\tau}
\newcommand{\dlS}{\ensuremath{\rm dlS}}

\newcommand{\F}{\ensuremath{\mathbb{F}}}
\newcommand{\M}{\ensuremath{\mathbb{M}}}
\newcommand{\ot}{\otimes}
\newcommand{\Fp}{\F_p}
\newcommand{\Fq}{\field}
\newcommand{\BH}{\textsc{BH}}
\newcommand{\ld}{\textsc{ld}}
\newcommand{\com}{\textsc{com}}
\newcommand{\sq}{\textsc{sq}}
\newcommand{\downsize}{\kappa}
\newcommand{\tobin}{\flat}
\newcommand{\downsizem}{\chi}

\newcommand{\K}{\ensuremath{\mathbb{K}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}
\newcommand{\Z}{\ensuremath{\mathbb{Z}}}

\newcommand{\mA}{\ensuremath{\mathcal{A}}}
\newcommand{\mB}{\ensuremath{\mathcal{B}}}
\newcommand{\mC}{\ensuremath{\mathcal{C}}}
\newcommand{\mE}{\ensuremath{\mathcal{E}}}
\newcommand{\mD}{\ensuremath{\mathcal{D}}}
\newcommand{\mF}{\ensuremath{\mathcal{F}}}
\newcommand{\mG}{\ensuremath{\mathcal{G}}}
\newcommand{\mH}{\ensuremath{\mathcal{H}}}
\newcommand{\mK}{\ensuremath{\mathcal{K}}}
\newcommand{\mM}{\ensuremath{\mathcal{M}}}
\newcommand{\mI}{\ensuremath{\mathcal{I}}}
\newcommand{\mJ}{\ensuremath{\mathcal{J}}}
\newcommand{\cM}{\ensuremath{\mathcal{M}}}
\newcommand{\mP}{\ensuremath{\mathcal{P}}}
\newcommand{\mQ}{\ensuremath{\mathcal{Q}}}
\newcommand{\mR}{\ensuremath{\mathcal{R}}}
\newcommand{\mS}{\ensuremath{\mathcal{S}}}
\newcommand{\mT}{\ensuremath{\mathcal{T}}}
\newcommand{\mU}{\ensuremath{\mathcal{U}}}
\newcommand{\mX}{\ensuremath{\mathcal{X}}}
\newcommand{\mY}{\ensuremath{\mathcal{Y}}}

\newcommand{\Inv}{\ensuremath{\textsc{Inv}}}
\newcommand{\GEN}{\ensuremath{\textsc{GEN}}}
\newcommand{\SAMP}{\ensuremath{\textsc{SAMP}}}
\newcommand{\epr}{\ensuremath{\textsc{epr}}}
\newcommand{\RM}{\ensuremath{\textsc{RM}}}
\newcommand{\RS}{\ensuremath{\textsc{RS}}}
\newcommand{\bRM}{\ensuremath{\textsc{RM2}}}
\newcommand{\Had}{\ensuremath{\textsc{Had}}}
\newcommand{\HRM}{\ensuremath{\textsc{HRM}}}


\newcommand{\Alg}{\mathcal{A}}
\newcommand{\ind}{\ensuremath{\mathrm{ind}}}


\newcommand{\setft}[1]{\mathrm{#1}}
\newcommand{\Density}{\setft{D}}
\newcommand{\Pos}{\setft{Pos}}
\newcommand{\Proj}{\setft{Proj}}
\newcommand{\Channel}{\setft{C}}
\newcommand{\Unitary}{\setft{U}}
\newcommand{\Herm}{\setft{Herm}}
\newcommand{\Obs}{\setft{Obs}}
\newcommand{\Lin}{\setft{L}}
\newcommand{\Trans}{\setft{T}}
\DeclareMathOperator{\poly}{poly}
\DeclareMathOperator{\negl}{negl}
\newcommand{\dset}{G}

\newcommand{\val}{\ensuremath{\mathrm{val}}}
\newcommand{\valco}{\ensuremath{\mathrm{val}^{\mathrm{co}}}}
\newcommand{\ia}{\Id_\alice}
\newcommand{\ib}{\Id_\bob}

\newcommand{\desc}[1]{\overline{\cal{#1}}}
\newcommand{\supp}{\textsc{Supp}}
\newcommand{\Gen}{\textsc{Gen}}
\newcommand{\Enc}{\textsc{Enc}}
\newcommand{\Dec}{\textsc{Dec}}

\newcommand{\GenTrap}{\textsc{GenTrap}}
\newcommand{\Invert}{\textsc{Invert}}
\newcommand{\lossy}{\textsc{lossy}}

\newcommand{\rand}{\textrm{rand}}
\newcommand{\had}{\textsc{Had}}


\newcommand{\eps}{\varepsilon}
\newcommand{\ph}{\ensuremath{\varphi}}


\newcommand{\ac}{\textsc{ac}}
\newcommand{\GX}{\textsc{Gap-Maxcut}}
\newcommand{\GNI}{\textsc{Graph Non-Isomorphism}}


\newcommand{\Acc}{\textsc{Acc}}
\newcommand{\Samp}{\textsc{Samp}}
\newcommand{\Ext}{\ensuremath{\text{Ext}}}

\newcommand{\BD}{\mathbb{QB}}
\newcommand{\DD}{\mathbb{D}}
\newcommand{\DDb}{\mathbb{D'}}
\newcommand{\Pot}{\Phi}
\newcommand{\inj}{J}
\newcommand{\mZ}{\mathcal{Z}}
\newcommand{\mN}{\mathcal{N}}
\newcommand{\vs}{\vspace{2mm}~\newline\noindent}
\newcommand{\vb}{\vspace{3mm}\noindent}
\newcommand{\sX}{\mathcal{X}}
\newcommand{\sA}{\mathcal{A}}
\newcommand{\sB}{\mathcal{B}}
\newcommand{\sY}{\mathcal{Y}}
\newcommand{\sR}{\mathcal{R}}


\newcommand{\trnq}[1]{\left[ {#1} \right]_q}

\DeclareMathOperator{\polylog}{polylog}
\newcommand{\mx}[1]{\mathbf{{#1}}}
\newcommand{\vc}[1]{\mathbf{{#1}}}
\newcommand{\abs}[1]{\left\vert {#1} \right\vert}
\newcommand{\norm}[1]{\left\| {#1} \right\|}
\newcommand{\for}{\text{for }}

\DeclareMathOperator{\arcsinh}{arcsinh}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\sgn}{sgn}


\newcommand{\E}{\mathop{\mathbb{E}}\displaylimits} % Expectation

\newcommand{\unif}{\mathcal{U}}
\newcommand{\pt}{\textrm{pt}}
\newcommand{\sample}{\textrm{sample}}
\newcommand{\test}{\textrm{test}}
\newcommand{\free}{\mathcal{F}}
\newcommand{\plane}{\mathcal{P}}
\newcommand{\lines}{\mathcal{L}}
\newcommand{\clines}{\mathcal{CL}}
\newcommand{\pl}{\mathbf{p}}
\newcommand{\individual}{\textrm{individual}}
\newcommand{\blocks}{\textrm{blocks}}
\newcommand{\liness}{\textrm{lines}}
\newcommand{\lp}{\mathcal{LP}}
\newcommand{\Pl}{\ensuremath{\mathrm{Pl}}}
\newcommand{\Ln}{\ensuremath{\mathrm{Lines}}}
\newcommand{\mode}{\mathfrak{m}}
\newcommand{\ECC}{\ensuremath{\textsc{ECC}}}
\newcommand{\EC}{\ensuremath{\textsc{EC}}}
\newcommand{\ENC}{\ensuremath{\textsc{ENC}}}
\newcommand{\cktval}{\ensuremath{\textsc{CKTVAL}}}


\newcommand{\GL}{\mathrm{GL}}
\newcommand{\Matrix}{\mathrm{M}}
\newcommand{\End}{\mathrm{End}}
\newcommand{\Aut}{\mathrm{Aut}}

\newcommand{\game}{\mathfrak{G}}
\newcommand{\sampler}{\mathcal{S}}
\newcommand{\decider}{\mathcal{D}}
\newcommand{\verifier}{\mathcal{V}}


\newcommand{\type}{\mathcal{T}}
\newcommand{\lt}{\mathcal{L}}
\newcommand{\rt}{\mathcal{R}}
\newcommand{\checker}{\mathcal{C}}


\newcommand{\gamestyle}[1]{\ensuremath{\textsc{#1}}\xspace}
\newcommand{\qld}{\gamestyle{QLD}}
\newcommand{\ms}{\gamestyle{MS}}
\newcommand{\pauli}{\gamestyle{P}}
%\newcommand{\bp}{\gamestyle{BP}}
\newcommand{\ora}{\gamestyle{Orac}}
\newcommand{\pcp}{\gamestyle{PCP}}
\newcommand{\ar}{\gamestyle{AR}}
\newcommand{\intro}{\gamestyle{Intro}}

\newcommand{\labelstyle}[1]{\ensuremath{\textsc{#1}}\xspace}
\newcommand{\EPR}{\labelstyle{EPR}}
\newcommand{\aux}{\labelstyle{aux}}
\newcommand{\ancilla}{\labelstyle{anc}}
\newcommand{\msc}{\labelstyle{MC}}
\newcommand{\msv}{\labelstyle{MV}}
\newcommand{\vertex}[1]{\labelstyle{V#1}}
\newcommand{\edge}[1]{\labelstyle{N#1}}
\newcommand{\basis}{\labelstyle{W}}
\newcommand{\xpt}{\labelstyle{X}}
\newcommand{\zpt}{\labelstyle{Z}}
\newcommand{\rxpt}{\labelstyle{R}_\xpt}
\newcommand{\rzpt}{\labelstyle{R}_\zpt}
\newcommand{\dir}[1]{\labelstyle{V#1}}
\newcommand{\coord}{\labelstyle{I}}
\newcommand{\intercept}{\labelstyle{U}}
\newcommand{\plf}{\labelstyle{Pl}}
\newcommand{\lnf}{\labelstyle{Ln}}
\newcommand{\ptf}{\labelstyle{Pt}}
\newcommand{\full}{\labelstyle{full}}
\newcommand{\opt}{\labelstyle{opt}}
\newcommand{\partition}{\mathcal{B}}

\newcommand{\tvarstyle}[1]{\mathsf{#1}}
\newcommand{\tvar}{\ensuremath{\tvarstyle{t}}}
\newcommand{\lvar}{\ensuremath{\tvarstyle{u}}}
\newcommand{\rvar}{\ensuremath{\tvarstyle{v}}}
\newcommand{\pvar}{\ensuremath{\tvarstyle{p}}}
\newcommand{\ovar}{\ensuremath{\tvarstyle{o}}}
\newcommand{\trole}{\ensuremath{v}} % used in intro types

\newcommand{\types}{\labelstyle{T}}

\newcommand{\decode}{\labelstyle{Decode}}

%\newcommand{\alice}{\labelstyle{Alice}}
%\newcommand{\bob}{\labelstyle{Bob}}
\newcommand{\alice}{\labelstyle{A}}
\newcommand{\bob}{\labelstyle{B}}

\newcommand{\oracle}{\labelstyle{Oracle}}
\newcommand{\ab}{\{\alice, \bob\}}

\newcommand{\typestyle}[1]{\ensuremath{\textsc{#1}}\xspace}
\newcommand{\Type}{\typestyle{Type}}
\newcommand{\Plane}{\typestyle{Plane}}
\renewcommand{\line}{\mathbf{\ell}}
\newcommand{\Llane}{\typestyle{Line}}
\newcommand{\Point}{\typestyle{Point}}
\newcommand{\HPoint}{\typestyle{HPoint}}
\newcommand{\Line}{\typestyle{Line}}
\newcommand{\ALine}{\typestyle{ALine}}
\newcommand{\DLine}{\typestyle{DLine}}
\newcommand{\Pair}{\typestyle{Pair}}
\newcommand{\Constraint}{\typestyle{Constraint}}
\newcommand{\Variable}{\typestyle{Variable}}
\newcommand{\Pauli}{\typestyle{Pauli}}
\newcommand{\Sample}{\typestyle{Sample}}
\newcommand{\Read}{\typestyle{Read}}
\newcommand{\MeasureX}{\typestyle{MeasureX}}
\newcommand{\Hide}[1]{\typestyle{Hide}_{#1}}
\newcommand{\HideX}[1]{\typestyle{HideX}_{#1}}
\newcommand{\Target}[1]{\typestyle{Target}_{#1}}
\newcommand{\Oracle}{\typestyle{Oracle}}
\newcommand{\Introspect}{\typestyle{Intro}}
\newcommand{\Intro}{\typestyle{Intro}}
\newcommand{\Simple}{\typestyle{Simple}}
\newcommand{\Eval}{\typestyle{Eval}}
\newcommand{\Agg}{\typestyle{Agg}}
\newcommand{\Input}{\typestyle{Input}}
\newcommand{\Skip}{\typestyle{Skip}}
\newcommand{\Alice}{\typestyle{Alice}}
\newcommand{\Bob}{\typestyle{Bob}}
\newcommand{\Edge}{\typestyle{Alice}}
\newcommand{\Vertex}{\typestyle{Bob}}
\newcommand{\Anchor}{\typestyle{Anchor}}
\renewcommand{\Game}{\typestyle{Game}}
\newcommand{\AB}{\{\alice, \bob\}}
\newcommand{\ctrl}{\labelstyle{c}}
\newcommand{\target}{\labelstyle{t}}

\newcommand{\abc}[1][\delta]{\otimes I_\bob \simeq_{#1} I_\alice \otimes}

\newcommand{\ldc}{k} % number of copies of classical ld tests

\newcommand{\class}[1]{\ensuremath{\mathsf{#1}}\xspace}
\newcommand{\NP}{\class{NP}} %
\newcommand{\IP}{\class{IP}} %
\newcommand{\EXP}{\class{EXP}} %
\newcommand{\NEXP}{\class{NEXP}} %
\newcommand{\QMA}{\class{QMA}} %
\newcommand{\QMIP}{\class{QMIP}} %
\WithSuffix\newcommand\QMIP*{\ensuremath{\class{QMIP}^*}} %
\newcommand{\PSPACE}{\class{PSPACE}} %
\newcommand{\PCP}{\class{PCP}} %
\newcommand{\MIP}{\class{MIP}} %
\newcommand{\MIPco}{\class{MIP}^{\mathrm{co}}} %
\newcommand{\RE}{\class{RE}} %
\newcommand{\coRE}{\class{coRE}}
\newcommand{\NEEXP}{\class{NEEXP}} %
\newcommand{\NEEEXP}{\class{NEEEXP}}
\WithSuffix\newcommand\MIP*{\ensuremath{\class{MIP}^*}} %
\newcommand{\QIP}{\class{QIP}} %


\newcommand{\Ent}{\mathscr{E}}
\newcommand{\compr}{\textsc{Compr}}
\newcommand{\halt}{\textsc{Halt}}
\newcommand{\machine}{\cal{M}}
\renewcommand{\cal}[1]{\mathcal{#1}}
\newcommand{\Kleene}{\cal{K}}
\newcommand{\qldparams}{\mathsf{qldparams}}
\mathchardef\mhyphen="2D
\newcommand{\Fqldparams}{\F_2\mhyphen\mathsf{qldparams}}
\newcommand{\introparams}{\mathsf{introparams}}
\newcommand{\ldparams}{\mathsf{ldparams}}
\newcommand{\tmldparams}{\mathsf{tmldparams}}
\newcommand{\pcpparams}{\mathsf{pcpparams}}

\newcommand{\TMtoSAT}{\mathrm{TMtoSAT}}
\newcommand{\TMtoLD}{\mathrm{TMtoLD}}
\newcommand{\BoundedHalting}{\mathrm{BH}}
\newcommand{\timecomplexity}{\mathsf{TIME}}
\newcommand{\TIME}{\mathsf{TIME}}
\newcommand{\answer}{\mathsf{ANS}}
\newcommand{\MS}{\mathrm{MS}}

\newcommand{\accept}{\typestyle{Accept}}
\newcommand{\reject}{\typestyle{Reject}}

\newcommand{\anch}{\gamestyle{Anch}}
\newcommand{\ans}{\gamestyle{ANS}}
%%%%%%%self testing macros%%%%%%%%%%

\newcommand{\local}{\mathrm{local}}
%\newcommand{\aux}{\mathrm{aux}}


\newcommand{\G}{\mG}
\newcommand{\XZ}{\mathcal{B}}
\newcommand{\hilb}{\mathcal{H}}


%\newcommand{\tmstyle}[1]{\ensuremath{\textsf{#1}}}
\newcommand{\tmstyle}[1]{\ensuremath{\mathsf{#1}}}
\newcommand{\Compress}{\tmstyle{Compress}}
\newcommand{\ComputeRepetitions}{\tmstyle{ComputeRepetitions}}
\newcommand{\ComputeSampler}{\tmstyle{ComputeSampler}}
\newcommand{\RawIntroSampler}{\tmstyle{RawIntroSampler}}
\newcommand{\ComputeIntroSampler}{\tmstyle{IntroSampler}}
\newcommand{\RawIntroDecider}{\tmstyle{RawIntroDecider}}
\newcommand{\ComputeIntroDecider}{\tmstyle{IntroDecider}}
\newcommand{\ComputeIntroVerifier}{\tmstyle{IntroVerifier}}
\newcommand{\ComputeOracleVerifier}{\tmstyle{OracleVerifier}}
\newcommand{\ComputeAnsVerifier}{\tmstyle{AnsRedVerifier}}
\newcommand{\ComputeParrepVerifier}{\tmstyle{RepeatedVerifier}}
\newcommand{\ComputePCPVerifier}{\tmstyle{PCPVerifier}}
\newcommand{\ComputeFixedPoint}{\tmstyle{ComputeFixedPoint}}
\newcommand{\detype}{\tmstyle{Detype}}

\newenvironment{gamespec}{
  \begin{mdframed}[style=figstyle]}{
  \end{mdframed}}

\newcommand{\zero}{\mathrm{zero}}

%%%%%%%From NW19:%%%%%%%%%%
\newcommand{\polymeas}[3]{\mathrm{PolyMeas}(#1,#2,#3)}
\newcommand{\simulpolymeas}[4]{\mathrm{PolyMeas}(#1,#2,#3, #4)}

\newcommand{\eval}{\mathrm{eval}}

%\newcommand{\coin}{o}
\newcommand{\succinctdecider}{\ensuremath{\mathsf{SuccinctDecider}}}
\newcommand{\circuit}{\mathcal{C}}
\newcommand{\formula}{\mathcal{F}}
\newcommand{\bin}{\mathrm{binary}}
\newcommand{\pcpeval}{\Xi}
\newcommand{\pcpverifier}{\mathcal{M}_\ar}
\newcommand{\qlen}{Q}
\DeclareMathOperator{\ev}{eval}

\newcommand{\hx}{\hat{x}}
\newcommand{\hz}{\hat{z}}
\newcommand{\htvar}{\hat{\tvar}}
\newcommand{\soundness}{\mathrm{sound}}

\newcommand{\rep}{\gamestyle{Rep}}
\newcommand{\sep}{\gamestyle{Sep}}

\newcommand{\binary}[1]{\mathrm{binary}_{#1}}
\newcommand{\num}[1]{\mathrm{number}_{#1}}
\newcommand{\canbasis}[1]{\mathrm{basis}(#1)}
\newcommand{\canH}[3]{H_{\mathrm{canon}, #1, #2, #3}}
\newcommand{\canlilh}[3]{h_{\mathrm{canon}, #1, #2, #3}}
\newcommand{\canin}[3]{\pi_{\mathrm{canon},#1,#2,#3}}
\newcommand{\canenc}[4]{g_{\mathrm{canon},#1,#2,#3,#4}}


% \usepackage{showlabels}
% \renewcommand{\showlabelfont}{\tiny\ttfamily\color{red}}

\bibliographystyle{alpha}

\newif\ifnotes\notestrue
%\newif\ifnotes\notesfalse

\input{marginnotes}
\begin{document}

\title{Efficiently stable presentations from error-correcting codes}

\author[1]{Michael Chapman}
\author[2]{Thomas Vidick}
\author[3]{Henry Yuen}
\affil[1]{}
\affil[2]{}
\affil[3]{}

\date{\today}
\maketitle

\noteswarning


\begin{abstract}

\end{abstract}


\section{Introduction}

\tnote{Make the connection with LCS}


	\section{Preliminaries}

\subsection{Notation}

When we write $\Es{i\in \mX}$ where $\mX$ is a finite set, we mean the expectation over $i$ chosen uniformly at random from $\mX$, i.e.\ $\frac{1}{|\mX|} \sum_{i\in \mX}$. For a vector $u \in \mX^n$ and a subset $S \subseteq [n]$, we write $u_S$ to denote the vector in $\mX^S$ which is the restriction of $u$ to $S$.

\subsection{Algebra}

  A \emph{tracial von Neumann algebra} is a pair $(\mM,\tau)$ of a von Neumann algebra $\mM$ together with a normal faithful tracial state $\tau$ on $\mM$, which we often refer to as the \emph{trace}. The main example of interest is $\mM=M_n(\C)$, the algebra $n\times n$ complex matrices, with $\tau$ the dimension-normalized trace, which we denote $\tr(M)=\frac{1}{n}\Tr(M)$. 	We write $\|x\|_\tau=\tau(x^*x)^{1/2}$ to denote the $2$-norm on $\mM$ with respect to $\tau$. \hnote{sometimes we use $\| \cdot \|_\tau$ below, which one should we use?}\tnote{Ah yes sorry. I prefer $\|\cdot\|_\tau$} \hnote{edited}
	
	Let $B(\ell_2)$ be the von Neumann algebra of bounded operators on $\ell_2$, the Hilbert space of convergent sequences in $\C^\Z$ equipped with the usual Euclidean norm (for which we let $(e_i)_{i \in \Z}$ denote the standard basis). We denote $\mM_\infty = \mM \overline{\otimes} B(\ell_2)$, where the overline denotes closure for the operator topology. $\mM_\infty$ is a von Neumann algebra equipped with the (infinite) trace $\tau_\infty = \tau \otimes \Tr$, with $\Tr(x)=\sum_{i\in \Z} e_i^T X e_i$ the trace on $B(\ell_2)$. We generally identify $\mM$ with the ``corner'' $\mM\otimes e_{1,1}\subset \mM_\infty$. 

	We let $\F$ denote a finite field, and $\field$ the field with two elements. For $u\in \F^n$ for some $n$, we write $|u|$ for the Hamming weight of $u$, i.e.\ the number of nonzero coordinates. For $a,b \in \F^k$, we write $a \cdot b$ to denote the inner product $\sum_{i=1}^k a_i b_i$. 
	
	
	\subsection{Measurements}
	\label{sec:measurements}
	
	A POVM in $\mM$ with outcome set $\mA$ is a finite collection of positive semidefinite operators $\{P_a\}_{a\in \mA}$ such that $\sum_a P_a = \Id_\mM$. A POVM is \emph{projective} if for all $a$, $P_a$ is a projection. 
	Given a projective measurement $\{P_a\}_{a\in \field^k}$ and $b\in \field^k$ we define the corresponding \emph{observable} 
	\[ \widehat{P}(b) = \sum_a (-1)^{a\cdot b} P_a\;,\]
	which is self-adjoint and unitary. If $k=1$, we often use the shorthand $\widehat{P}$ for $\widehat{P}(1) = P_0-P_1$.
	
	We define a specific family of projective measurements on $M_{2^k}(\C)$ which are derived from the \emph{Pauli observables}. Define
	\begin{equation}\label{eq:def-pauli-1} \sigma^X = \begin{pmatrix} 0 & 1 \\ 1 & 0 \end{pmatrix}\;,\qquad \sigma^Z = \begin{pmatrix} 1 & 0 \\ 0 & -1\end{pmatrix}\;,
	\end{equation}
	and more generally for $a,b\in \F_2^k$ let 
	\begin{equation}\label{eq:def-pauli-2}
	\sigma^X(a) = \bigotimes_{i=1}^t (\sigma^X)^{a_i}\qquad\text{and}\qquad\sigma^Z(b) = \bigotimes_{i=1}^t (\sigma^Z)^{b_i}\;,
	\end{equation}
	which are observables in $M_{2^k}(\C)$. These are self-adjoint unitary operators called Pauli observables. Each observable $\sigma^X(a)$ (resp. $\sigma^Z(b)$) corresponds to the \emph{Pauli measurement} $\{ \sigma^X_a \}_{a \in \F_2^k}$ (resp. $\{ \sigma^Z_b \}_{b \in \F_2^k}$) where (in a slight abuse of notation)  
	%	We slightly abuse notation and write 
	\[ \sigma^X_a = \Es{\alpha\in\F_2^k} (-1)^{a\cdot \alpha} \sigma^X(\alpha)\qquad\text{and}\qquad\sigma^Z_b = \Es{\beta\in\F_2^k} (-1)^{b\cdot\beta} \sigma^Z(\beta).\]
	It is easy to verify that $\{\sigma^X_a\}_a$ and $\{\sigma^Z_b\}_b$ are projections summing to identity.	
	
	
	We will make use of the following. It is an application of \emph{orthonormalization}, which transforms a nearly-orthogonal measurement to a nearby orthogonal measurement. See e.g.~\cite{kempe2011parallel,ji2020quantum} or~\cite[Theorem 1.2]{de2021orthogonalization} for the version that we use here. 
	
\begin{lemma}\label{lem:pull-back}
Let  $(\mM,\tau^\mM)$ be a tracial von Neumann algebra, $P\in\mM_\infty$ a projection of finite trace, $\mN=P\mM_\infty P$ and $\tau^\mN=\tau_\infty/\tau_\infty(P)$, and $w\in P \mM_\infty \Id_\mM$ a partial isometry. Let 
\[ \eps = \max\big\{ \tau^\mM\big(\Id_\mM - w^* w\big)\,,\;\tau^\mN\big( P- w w^*\big)\big\}\;.\] 
 Then for any projective measurement $\{T_a\}_{a \in \mA}$ on $\mN$, there is a projective measurement $\{Q_a\}_{a \in \mA}$ on $\mM$ such that 
\begin{equation}
\label{eq:pull-back} \sum_{a \in \mA} \big\| Q_a - w^* T_a w\big\|_\tau^2 \,\leq \ 56\eps\;.
\end{equation}
\end{lemma}	

\begin{proof}
If $\eps\geq \frac{1}{2}$ the conclusion is trivial (for a suitably large implicit constant in the $O(\cdot)$ notation in \eqref{eq:pull-back}), so assume $\eps<\frac{1}{2}$. 
Define 
\[\tilde{Q}_a = w^* T_a w  + \frac{1}{|\mA|}\big(\Id_\mM - w^* w\big) \in \mM\;.\]
Then $\{\tilde{Q}_a\}$ is a POVM on $\mM$. Moreover, 
\begin{align*}
\sum_a \tau^\mM \big( \tilde{Q}_a^2 \big) &\geq \sum_a \tau^\mM \big( \big(w^* T_a w \big)^2 \big) \\
&= \sum_a \tau^\mM \big(  w^* T_a w w^*T_a w \big)\\
&= \sum_a \tau^\mM \big(  w^* T_a  P T_a w \big) - \sum_a \tau^\mM \big( w^* T_a  ( P - w w^*) T_a w \big)\\
&\geq 1 - \eps -  \sum_a \tau_\infty \big( w^* T_a  ( P - w w^*) T_a w \big)\\
&\geq 1 - \eps -  \tau_\infty\Big(\big( P - w w^*\big)\Big(\sum_a  T_a w w^* T_a\Big)\Big)\\ 
&\geq 1- \eps- \tau_\infty\big( P- w w^*\big)\;,
\end{align*}
where the third line uses that $T_aPT_a=T_a$, $\sum_a T_a = \Id_\mN$ and the definition of $\eps$ for the first term, and for the second the fact that for $A\in\mM$, $\tau^\mM(A)=\tau_\infty(A)$ by definition of $\tau_\infty$ and the identification of $\mM$ with a ``corner'' in $\mM_\infty$, the fourth line uses cyclicity of the trace for the second, and the last uses $\|ww^*\|,\|\sum_a T_a\|_\infty\leq 1$. By assumption, 
\begin{align*}
\tau_\infty\big( P- w w^*\big) \,\leq\, \eps\, \tau_\infty(P)\,\leq \frac{\eps}{1-\eps}\;.
\end{align*}
where the last inequality is because by definition, $\tau^N(P)=1$, thus
\[1-\eps \,\leq\, \tau^\mN(ww^*) \,=\, \frac{\tau_\infty(ww^*)}{\tau_\infty(P)}\,=\, \frac{\tau_\infty(w^*w)}{\tau_\infty(P)}  \,\leq\, \frac{1}{\tau_\infty(P)}\]
since $\tau_\infty(w^* w) = \tau^\mM(w^* w)$ and $w^*w\leq I_\mM$. Overall, 
\[ \sum_a \tau^\mM \big( \tilde{Q}_a^2 \big) \,\geq\, 1-\eps-\frac{\eps}{1-\eps}\,\geq\, 1-3\eps\;.\]
To conclude we apply~\cite[Theorem 1.2]{de2021orthogonalization} to obtain a projective measurement $\{Q_a\}$ on $\mM$ such that 
\begin{equation*}
\sum_a \big\|{Q}_a - \tilde{Q}_a \big\|^2_\tau \,=\, 27\eps\;.
\end{equation*}
Finally,
\begin{align*}
\sum_a \big\|{Q}_a - w^*{T}_a w\big\|^2_\tau &= \sum_a \Big\|{Q}_a - \tilde{Q}_a  + \frac{1}{|\mA|}\big(I_\mM - w^* w\big) \Big\|^2_2\\
&\leq  \sum_a 2\big\|{Q}_a - \tilde{Q}_a\big\|_\tau^2  + 2\frac{1}{|\mA|}\big\|I_\mM - w^* w\big\|_\tau^2 \\
&\leq 54 \eps + 2 \tau^\mM( (I_\mM - w^* w)^2 ) \\
&\leq 54 \eps + 2 \tau^\mM(I_\mM - w^* w ) \\
&\leq 56 \eps\;,
\end{align*}
where the second line is by the triangle inequality, the fourth line is due to the fact that $I_\mM - w^* w$ is positive and has operator norm at most $1$, and the last line is by $\tau^\mM(I_\mM - w^* w ) \leq \eps$.
\end{proof}

	
\subsection{Nonlocal games}

We give standard definitions on nonlocal games. 

\begin{definition}[Game]
A game is a tuple $(\mX,\mu,\mA,D)$ where $\mX$ is a finite set, $\mu$ a distribution on $\mX\times \mX$, $\mA=(\mA(x))_{x\in\mX}$ a collection of finite sets, and 
\[ D: \big\{ (x,y,a,b) : (x,y)\in\text{supp}(\mu),a\in\mA(x),b\in\mA(y)\big\} \;\to\;\{0,1\}\]
such that $D$ is symmetric, i.e. $D(x,y,a,b)=D(y,x,b,a)$ whenever both terms are defined. We often abuse notation and write $\mu$ for the symmetrized marginal of $\mu$, i.e.\ 
\[\mu(x) := \sum_{x'\in \mX} \frac{1}{2}\big(\mu(x,x')+\mu(x',x')\big)\;.\]
\end{definition}

The interpretation of $G=(\mX,\mu,\mA,D)$ as a nonlocal game is the following. In the ``game'', a referee is imagined to sample a pair of ``questions'' $(x,y)\sim \mu$. The question $x$ is sent to a first player, ``Alice,'' and the question $y$ is sent to a second player, ``Bob.'' Each player is tasked with responding with an answer $a\in \mA(x)$ for Alice, and $b\in \mA(y)$ for Bob. The referee accepts the players' answers if and only if $D(x,y,a,b)=1$. 

Nonlocal games provide a framework to study different kinds of bipartite correlations: depending on the level of coordination allowed between Alice and Bob, they may have varying chances of success in the game. 

In quantum mechanics, a local strategy for the players (meaning that each player is required to determine their answer locally, without exchanging information with the other player) is specified by the following. 

\begin{definition}[Synchronous strategy]
If $G=(\mX,\mu,\mA,D)$ is a game and $(\mM,\tau)$ a tracial von Neumann algebra, a \emph{synchronous strategy $\strategy$ for $G$ on $(\mM,\tau)$} is, for every $x\in \mX$, a projective measurement $(P^x_a)_{a\in \mA(x)}$ on $\mM$. The value of a strategy $\strategy$ in $G$ is 
\[ \omega(G;\strategy)\,=\, \sum_{(x,y)\in\mX\times\mX}\frac{1}{2}\big(\mu(x,y)+\mu(y,x)\big) \sum_{(a,b)\in\mA(x)\times\mA(y)} D(x,y,a,b)\, \tau\big(P^x_a \,P^y_b\big) \;.\footnote{Note the symmetrization of $\mu$. This is to avoid explicitly requiring $\mu$ to be permutation-invariant in the definition of a game.}\]
We say that $\strategy$ is \emph{perfect} if $\omega(G;\strategy)=1$.
\end{definition}
	
The name \emph{synchronous} stems from the fact that whenever an identical pair $(x,x)$ is chosen, $\tau(P^x_a P^x_b)=0$ for $a\neq b$ due to the requirement that $\{P^x_a\}_a$ is a projective measurement. Thus a synchronous strategy always returns the same answer to the same question. More general strategies, which allow different operators $\{P^x_a\}$ and $\{Q^y_b\}$, do not automatically enforce the synchronicity condition, but we do not consider such strategies here. 
	
		
\section{Stability}

In this section we give definitions associated with the notion of ``efficient stability'' used in the paper. We reformulate a few previously known results in this framework, and give some examples that will be used later on. 

\subsection{Approximate homomorphisms}

Given a set $S$, we let $\mF(S)$ denote the free group generated by $S$. We freely identify functions from $S$ to $H$, where $H$ is any group, with homomorphisms from $\mF(S)$ to $H$. If $R$ is a subset of $\mF(S)$ then the quotient of $\mF(S)$ by the normal subgroup generated by $R$ is denoted $\langle S:R\rangle$. 

%\tnote{not sure we need this:}For convenience we adopt the following notation from~\cite{slofstra2019set}. A \emph{group over $\Z_2$} is a pair $(G,J)$ of a finitely presented group $G$ and a central element $J$ of $G$ of order $2$. Any such group has a presentation $G=\langle S:R\rangle$ where $J\in S$ and $R$ includes the relations $J^2=e$ and $[J,s]=e$ for every $e\in S\backslash\{J\}$. We use the notation 
%\[ \langle S:R\rangle_{\Z_2} \,=\, \langle S\cup\{J\} : R\cup\{[J,s]=e:s\in S\}\cup\{J^2=e\}\rangle\;.\]

In~\cite[Section 2]{hadwin2018stability} a notion of $\eps$-\emph{almost homomorphism} from a finitely presented group to a unital tracial $C^*$-algebra $\mA$ is introduced. Informally, an $\eps$-almost homomorphism of $G=\langle S:R\rangle$ is a map from $S$ to $\mU(\mA)$ that approximately respects all relations in $R$. We give a variant of their definition that quantifies the error in an average sense. 

\begin{definition}[Almost homomorphism]
Let $G = \langle S:R\rangle $ be a finitely presented group, $\mu$ a distribution on $R$, and $(\mM,\tau)$ a tracial von Neumann algebra. An $(\eps,\mu)$-almost homomorphism of $G$ on $(\mM,\tau)$ is a homomorphism $\phi:\mF(S)\to\mU(\mM)$ such that
\[ \Es{r\sim \mu} \big\|  \phi(r) - \Id \big \|_\tau^2 \,\leq\, \eps\;.\]
\end{definition}

We note that this notion depends on the presentation of $G$, not only on the group itself. 
When the distribution $\mu$ is uniform over the set $R$, we simply write $\eps$-homomorphism. The definition is consistent with the usual notion of a (unitary) homomorphism, which is recovered when $\eps=0$. 

A stability result is a statement that $\eps$-homomorphisms are close to homomorphisms. To measure the distance between homomorphisms into different algebras we make the following definition. 


\begin{definition}[Closeness]\label{def:close}
Let $\{U_i\}\subseteq \mM$ and $\{V_i\}\subseteq \mN$ be two families of unitaries on  tracial algebras $(\mM,\tau^\mM)$ and $(\mN,\tau^\mN)$ respectively, indexed by the same set $\mI$. For $\delta\geq0$ and $\mu$ a measure on $\mI$ we say that $\{U_i\}$ and $\{V_i\}$ are $(\delta,\mu)$-close if there exists a projection $P\in\mM_\infty$ of finite trace such that $\mN=P\mM_\infty P$ and $\tau^\mN=\tau_\infty/\tau_\infty(P)$, and a partial isometry $w\in P \mM_\infty \Id_\mM$ such that 
\[ \Es{i\sim\mu} \big\| U_i - w^* V_i w \big\|_{\tau^\mM}^2 \,\leq\,\delta\]
and 
\[\max\big\{ \tau^\mM(\Id_\mM-w^*w)\,,\; \tau^\mN(P-ww^*)\big\} \,\leq\, \delta\;.\]
If $\phi:\mI\to \mU(\mM)$ and $\psi:\mI\to \mU(\mN)$ then we say that $\phi$ and $\psi$ are $(\delta,\mu)$ close if the families $\{\phi(i)\}$ and $\{\psi(i)\}$ are. 
If the measure $\mu$ is omitted then it is understood to be the uniform measure on $\mI$.
\end{definition}

We now give our definition of stability.

\begin{definition}\label{def:eff-stab}
Let $G = \langle S:R\rangle $ be a finitely presented group. Let $\mC$ be a class of tracial von Neumann algebras. Let $\mu_S$ be a distribution on $S$ and $\mu_R$ a distribution on $R$. For $\delta:[0,1]\to[0,1]$ such that $\lim_{t\to 0}\delta(t)=0$ we say that the presentation $G=\langle S:R\rangle$ is $(\delta,\mu_S,\mu_R,\mC)$-stable if for every $(\cM,\tau)$ in $\mC$, every $(\eps,\mu_R)$-almost homomorphism of $G$ is $(\delta(\eps),\mu_S)$-close to a unitary representation of $G$ on some $(\mN,\tau^\mN)\in \mC$. \tnote{added:} We refer to the function $\delta$ as the ``modulus of stability'' of the presentation.
\end{definition}



\subsection{General results}

We do not know many general results about stability. We give two. First of all, 
for a finite group $G$ we can always write $G=\langle S:R\rangle$ where $S = G$ and $R=\{ g\cdot h \cdot (gh)^{-1} =e \}$. We refer to this presentation as the \emph{exhaustive presentation}. If we let $\mu_S$ and $\mu_R$ be the uniform distribution on $S$ and on $R$ respectively then Definition~\ref{def:eff-stab} reduces to a widely used notion of \emph{flexible (Hilbert-Schmidt) stability}. In particular, for finite groups the following result is known~\cite{gowers2017inverse,de2019operator}. We adopt the formulation from~\cite[Theorem 1.4]{de2022spectral}.

\begin{theorem}\label{thm:gh}
Let $G$ be a finite group and $\mC$ the class of all tracial von Neumann algebras. Let $\mu_S$ and $\mu_R$ be the uniform distribution on $S=G$ and $R=\{ g\cdot h \cdot (gh)^{-1}=e \}$ respectively. Then $G=\langle S:R\rangle$ is $(O(\eps),\mu_S,\mu_R,\mC)$-stable.
\end{theorem}

Next we state a result from~\cite{de2022spectral} which allows to combine stability results. The results in~\cite{de2022spectral} are rather general, and in particular imply that the direct product of stable groups is stable. Here, we will only use the following specialization to the case of $\Z_2^k$. For a measure $\mu$ on $\Z_2^k$, define its spectral gap 
\[ \kappa = \max_{a\neq 0} \frac{1}{1-\Es{b\sim\mu}(-1)^{a\cdot b}}\;.\] 

\hnote{I am wondering how exactly the comment above connects with the next theorem. For example, what is the ``direct product'' here? Also, is there a way to explain where  $(-1)^{a \cdot b}$ comes from? For someone who doesn't know what's coming next it may not be apparent where this is from.}\tnote{I thought it's clear that the theorem applies to a specific semidirect poduct. So but yes I agree that this should be introduced better}

\begin{theorem}[\cite{de2022spectral} Corollary 2.6]\label{thm:dls-gap}
Let $\mu$ be a measure on $\Z_2^k$ with spectal gap $\kappa$. Let $\phi_X,\phi_Z: \Z_2^k \to \mU(\mM)$ be two homomorphisms such that
\[ \Es{a,b\sim \mu} \big\| \phi_X(a)\phi_Z(b)-(-1)^{a\cdot b} \phi_Z(b)\phi_X(a)\big\|_\tau^2 \,\leq\,\eps\;.\]
Then there is an $\mN=P\mM_\infty P$ and homomorphisms $U_X,U_Z:\Z_2^k\to\mU(\mN)$ and $\delta=O(\kappa^2\eps)$ such that $\phi_X$ and $U_X$ are $(\delta,\mu)$-close, $\phi_Z$ and $U_Z$ are $(\delta,\mu)$-close, and moreover $U_X(a)U_Z(b)=(-1)^{a\cdot b}U_Z(b)U_X(a)$ for all $a,b\in\Z_2^k$.
\end{theorem}




\subsection{Examples}

As a first example we spell out the application of Theorem~\ref{thm:gh} to the case of $G=\Z_2^k$. 

\begin{corollary}\label{cor:lin-test} %\tnote{Stated this for finite dimensions. Not sure what we want in the end}
Let $d\geq 1$ and $\phi:\Z_2^k \to \mU(\mM)$ be such that 
\[ \Es{x,y\in \Z_2^k} \big\| \phi(x)\phi(y)-\phi(x+y) \big\|_{\tau}^2 \,\leq\,\eps\;.\]
Then there is a %$d'=(1+O(\eps))d$, an isometry $w:\C^d \to \C^{d'}$ and a 
projective measurement $\{P_u\}_{u\in \Z_2^k}$ on $\mM$ such that 
\[ \Es{x\in \Z_2^k} \Big\| \phi(x) -\Big(\sum_u (-1)^{u\cdot x} P_u\Big)  \Big\|_{\tau}^2 \,=\, O(\eps)\;.\]
\end{corollary} 

\begin{proof}
Any $\phi$ as in the corollary statement is an $(\eps,U_R)$-almost homomorphism of $\Z_2^k$ into $(\mM,\tau)$ for the exhaustive presentation. Applying Theorem~\ref{thm:gh}, $\phi$ is $O(\eps)$-close to a homomorphism from $\Z_2^k$ to some $(\mN,\tau^\mN)$. Because $\Z_2^k$ is Abelian, such a homomorphism is given by commuting unitaries $(U_x)_{x\in\Z_2^k}$ on $\mM$. Moreover, since $\Z_2^k$ is a $2$-group, each $U_x$ satisfies $U_x^2=\Id$, hence $U_x=U_x^*$.

For every $u\in  \Z_2^k$ let $Q_u = \Es{x} (-1)^{u\cdot x} U_x$. Then each $Q_u$ is a projection such that $\sum_u Q_u=\Id$. Using Lemma~\ref{lem:pull-back}, we find a projective measurement $\{P_u\}$ on $\mM$ that satisfies the conclusions of the corollary. 
\end{proof}

The ``exhaustive'' presentation of $\Z_2^k$ is not very ``efficient'', in the sense that it has as many generators as the group size, and quadratically as many relations. There is a much more ``efficient'' presentation of $\Z_2^k$, given by

\begin{equation}\label{eq:z2-efficient}
 \Z_2^k = \langle x_1,\ldots,x_k : [x_i,x_j]=e, x_i^2=e \; \forall i\neq j \rangle\;.
\end{equation}

We call this presentation ``efficient'' because it has a number of generators and relations that is far smaller than those of the exhaustive presentation (in this case, polylogarithmic in the group size). The following lemma shows that this presentation is also stable. 



\begin{lemma}[Lemma 3.8 in~\cite{slofstra2019set}]\label{lem:eff-z2}
For every $k$, there is a $\delta_k = O_k(\eps)$ such that the presentation~\eqref{eq:z2-efficient} is $\delta_k$-stable. Furthermore, the close representation can be taken on the same algebra. \hnote{Is there a reason to do $O_k(\eps)$ instead of writing out what the dependence of $k$ is in this lemma? I feel like this is an important aspect of the result (which motivates the later results...)}\tnote{Yes, the motivation was to first hide it, and then expand in the comment (which makes it clear that some $O_k(\eps)$ will always be true for a finite group, and that we care precisely about the $k$-dependence, which at first one might not ``notice''. Some of the stuff here I did not fine-tune too much the presentation of, because I thought we'll do that once we agree with the rough outline of the results and work on an intro and possible reorganization if needed. I agree it's not optimal now.}
\end{lemma}

As one would naturally expect, the dependence of $\delta_k$ on $k$ depends on the girth of $\Z_2^k$ for the presentation~\eqref{eq:z2-efficient}. By expressing each element of $\Z_2^k$ as a product of generators in the natural way, applying Corollary~\ref{cor:lin-test} it is possible to show that $\delta_k=O(k^2\eps)$ in Lemma~\ref{lem:eff-z2}. With more work one can get $\delta_k=O(k\eps)$, see~\cite[Theorem 3.2]{chao2017overlapping}. This is nearly tight, as shown in~\cite{chao2017overlapping}. In the next section we will obtain presentations of $\Z_2^k$ that have a much better size/modulus tradeoff.

We end with a non-Abelian group that plays an important role in applications in quantum information, the \emph{Pauli group}. For an integer $k\geq 1$,  the Pauli group $\pauli_k$ can be defined as follows. Let $\gamma: \Z_2^k\times \Z_2^k \to \{-1,1\}$ be given by $\gamma(a,b)=(-1)^{a\cdot b}$. Then $\pauli_k$ is the central extension of $\Z_2^k\times \Z_2^k$ by $\{-1,1\}$ given by $\gamma$. Alternatively, $\pauli_k$ is the group generated by the Pauli matrices $\sigma_X(a)$, $\sigma_Z(b)$ introduced in~\eqref{eq:def-pauli-2}.
It is also known as the Heisenberg group 
\[ H_{2k+1} = \left \{ \begin{pmatrix} 1 & a & c \\ 0 & I_{k \times k} & b \\ 0 & 0 & 1 \end{pmatrix} \right\}\subseteq {\mathrm{GL}}_{k+2}(\F_2)\;.\]
 Concretely, %we label elements of the Pauli group as triples $(c,a,b)$ 
% where $c\in\{0,1\}$ and $a,b\in\Z_2^k$, and 
we consider the following presentation for the Pauli group:
\begin{align*}
 \pauli_k \,=\, \big\langle \{J\}\cup  \{(a,b): a,b\in \Z_2^k\} &: a^2=b^2=J^2=e,\; [a,J]=[b,J]=e,\\
&\qquad  (a,b)(a',b') = J^{a\cdot b'} (a',b')(a,b) \; \quad \forall a,b\big\rangle\;.
\end{align*}
This presentation is not quite the exhaustive presentation (it has $2^{2k}+1$ generators, whereas $|\pauli_k|=2^{2k+1}$), but it is not far from it.  
Applying Theorem~\ref{thm:gh} we obtain the following consequence.%, which we again state only for the case of a subclass of approximate homomorphisms and the class of finite-dimensional matrix algebras\tnote{again, not sure what we want ultimately}. 

\begin{corollary}[Pauli braiding test]
Let $\phi_X,\phi_Z:\Z_2^k \to \mU(\mM)$ be such that for all $W\in \{X,Z\}$,
\[ \Es{a,b\in \Z_2^k} \big\| \phi_W(a)\phi_W(b)-\phi_W(a+b) \big\|_\tau^2 \,\leq\,\eps\;,\]
and
\[ \Es{a,b\in \Z_2^k} \big\| \phi_X(a)\phi_Z(b)- (-1)^{a\cdot b} \phi_Z(b)\phi_X(a) \big\|_{\tau}^2 \,\leq\,\eps\;.\]
Then there is a partial isometry $w\in P\mM_\infty I_\mM$ such that for all $W\in \{X,Z\}$, \tnote{This is a bit sketchy; we need $\mN = (\C^2)^{\otimes n} \otimes \mN'$. I wasn't quite sure how to spell it out}
\[ \Es{W\in \Z_2^k} \big\| \phi_W(a) - w^* \big(\sigma_W(a)\otimes \Id\big) w \big\|_{\tau}^2 \,=\, O(\eps)\;.\]
\end{corollary}

\begin{proof}[Proof sketch]
\tnote{todo}
\end{proof}

Similarly to Lemma~\ref{lem:eff-z2} we can state an ``efficient'' version of the preceding corollary, which applies to the presentation
\begin{align}
 \pauli_k = \big\langle x_1,\ldots,x_k,z_1,\ldots,z_k &: x_i^2=z_i^2=J^2=e,\; [x_i,J]=[z_i,J]=e,\notag\\
&\qquad  [x_i,x_j]=[z_i,z_j]=[x_i,z_j]=e, [x_i,z_i]=J \quad \forall i\neq j \big\rangle\;.\label{eq:pauli-efficient}
\end{align}

\begin{lemma}\label{lem:eff-pauli}
For every $k$, there is a $\delta'_k = O_k(\eps)$ such that the presentation~\eqref{eq:pauli-efficient} is $\delta_k$-stable. \hnote{again, I think it would be instructive to put in the dependence on $k$.}
\end{lemma}

\begin{proof}
This follows from Lemma~\ref{lem:eff-z2} and Theorem~\ref{thm:dls-gap}.
\end{proof}

\section{Presentations from codes}

In this section we present our main result, which is an ``efficient'' stable presentation of $\Z_2^k$. Most of the technical work required to show this result is done in~\cite{ji2020mip}. Here, we introduce the language required to reformulate their result in the framework of this paper. 

As a first step, we introduce a general method for translating any binary linear error-correcting code into a presentation of $\Z_2^k$. 

\subsection{Presentations from codes}
\label{sec:pres-code}

For $q$ a prime power and $n,k,d$ integer, a linear $[n,k,d]_q$ code $\code$ is a $k$-dimensional subspace of $\F_q^n$ such that for all $x\in \code$ such that $x\neq 0$, the Hamming weight $|x|$ (i.e. the number of nonzero coordinates of $xs$) is at least $d$. The parameter $n$ is called the \emph{length} of the code, $k$ its \emph{dimension} and $d$ its \emph{distance}. A code can be specified by a \emph{parity check matrix} $h\in \F_q^{m\times n}$ such that $\code = \ker h$. 

For the remainder of this section we specialize the discussion to the case where $q=2$. 
A parity check matrix for a code of dimension $k$ implies a presentation in the following way. Introduce $n$ generators $S=\{x_1,\ldots,x_n\}$. Each of the generators is required to be an involution: $x_i^2=e$. For each row $i\in \{1,\ldots,m\}$ of the parity check matrix $h$, introduce a relation 
\[ R_i\,:\; \prod_{1\leq j \leq n} x_j^{h_{ij}}=e \]
that ``verifies'' the parity check associated with the $i$-th row of $h$. Finally, to guarantee that $R_i$ is independent of the order in which the $x_j$ are multiplied, whenever $j\neq j'$ are such that $h_{ij}$ and $h_{ij'}$ are both nonzero we require that $x_j$ and $x_{j'}$ commute. This can be written succinctly using a relation 
\[ R'_{ijj'}\,:\; [x_j,x_{j'}]^{h_{ij} h_{ij'}}=e\;.\]
The presentation obtained in this way defines a group $G=G(h)$ as 
\begin{equation}\label{eq:def-gh-pres}
 G(h) \,=\, \big\langle x_1,\ldots,x_n \,:\, x_j^2=e\,,\; R_i\,,\; R'_{ijj'}\,,\quad \forall 1\leq i\leq m,\, 1\leq j< j' \leq n\big\rangle\;.
\end{equation}
Note that we made the dependence of $G(h)$ on $h$ explicit. This is because in general, the group defined in this way may depend on $h$, and not only on $\code$. If however we further impose all pairwise commutation relations then we obtain the following. 

\begin{lemma}\label{lem:com-code}
Let $R''_{jj'}$ be the commutation relation $[x_j,x_{j'}]=e$. Then
\[ \Z_2^k \,=\, \big\langle x_1,\ldots,x_n \,:\, x_j^2=e\,,\; R_i\,,\; R''_{jj'}\,,\quad \forall 1\leq i\leq m,\, 1\leq j< j' \leq n\big\rangle\;.\]
\end{lemma}

\begin{proof}
The group defined by the right-hand side is obviously Abelian and a $2$-group, so it is of the form $\Z_2^{k'}$ for some $k'$. In fact, it is equal to the quotient of $\Z_2^n$ by the subgroup generated by the $\prod_{1\leq j \leq k} x_j^{h_{ij}}$. So it is $\Z_2^k$ where $k=n-\dim\textrm{im}\ h = \dim\ker h=\dim \code$.  
\end{proof}

\begin{remark}
There exists matrices $h$ such that $G(h)$ is not $\Z_2^k$, and in fact is not Abelian. For an example, see~\cite[Example 2.16]{paddock2022arkhipov}.  
\end{remark}


For readability it is convenient to reformulate the parity check matrix as a \emph{tester} for the code. This allows us to give a more succinct, ``algorithmic'' definition of a parity check matrix for a given code. Informally, the tester takes as input a word $w\in \F_2^n$ and determines if $w\in \code$ by selecting a parity check at random and evaluating it. 
 Specifically we give the following definition. (For the sake of later use, we state the definition for the case of a general prime power $q$.)

\begin{definition}[$r$-local linear tester]\label{def:code-test}
Let $\code$ be an $[n,k,d]_q$ linear code and $r\in \N$.
An \emph{$r$-local linear tester for $\code$} is a pair $M = ((v_S)_{S \subseteq [n]},\nu)$ where $\nu$ is a distribution over subsets $S\subseteq [n]$ of size at most $r$, and for each such subset a vector $v_S\in\F_q^S$, such that $u\in \code$ if and only if for all $S$ in the support of $\nu$, $v_S\cdot u_S=0$ where $u_S$ denotes the restriction of $u$ to coordinates in $S$.\footnote{Generally one imposes stronger ``soundness'' conditions on the tester. However, we will not need to be more specific than this. \hnote{This is probably a very vague comment that only makes sense to those who already know LTCs :)}} \hnote{Given that we've already talked about parity check matrices, it seems easier to define a local linear tester for a code $\code$ as a pair $(h,\nu)$ where $h \in \F^{m \times n}$ is a parity matrix for $\code$ and $\nu$ is a distribution over $\{1,\ldots,m\}$.}\tnote{Yes ok. I didn't change now but I'm in favor}

\hnote{ok, here's the parity check version} Let $\code$ be an $[n,k,d]_q$ linear code and $r\in \N$. An \emph{$r$-local linear tester for $\code$} is a pair $M = (h,\nu)$ where $h \in \F^{m \times n}$ is a parity matrix for $\code$ and $\nu$ is a distribution over $\{1,\ldots,m\}$. \hnote{below, everywhere a tester is defined, I added a ``parity check'' version of it.}
\end{definition}

We end this section with an example, the \emph{Hadamard code}. This code can be defined for any  $t\geq 1$ and it is a $[T,t,T/2]_2$ linear code, where $T=2^t$. For simplicity we write  $\code_\had$ to denote this code, omitting $t$. As a linear space, $\code_\had$ is the span of all $(x_i)_{x\in \field^t} \in \field^T$, for $i\in \{1,\ldots,t\}$.  

A parity check matrix for $\code_\had$ is the matrix $h_\had\in \F_2^{T^2\times T}$ defined as follows. Identify the rows of $h_\had$ with pairs $(x,y)\in \F_2^t\times \F_2^t$, and the columns of $h_\had$ with $\F_2^t$. Then the $(x,y)$-th row of $h_\had$ has nonzero entries at positions $x,y$ and $x+y$ only. The corresponding $3$-local linear tester is $M_\had=((v_S),\nu)$ where $\nu$ is uniform over triples $\{x,y,x+y\}$ for $(x,y)\in \F_2^t\times \F_2^t$ and $v_S = (1,1,1)^T$ for all $S$ in the support of $\nu$. \hnote{here's the parity check version:} The corresponding $3$-local linear tester is $M_\had = (h_\had,\nu)$ where $\nu$ is the uniform distribution over $\F_2^t \times \F_2^t$. This tester can be described more algorithmically as in Figure~\ref{fig:test-had}. 

\begin{figure}[!htbp]
  \centering
  \begin{gamespec}
	Given access to some $g\in \F_2^T$, where $T=2^t$, identify $g$ with a function $g:\F_2^t\to\F_2$. Perform the following. 
\begin{enumerate}
\item Select $(x,y)\in \F_2^t \times \F_2^t$ uniformly at random. 
\item Accept if and only if $g(x)+g(y)+g(x+y)=0$.  	
    \end{enumerate}
  \end{gamespec}
  \caption{A $3$-local linear tester for $\code_{\had}$}
  \label{fig:test-had}
\end{figure}

\begin{remark}
Since each pair of coordinates $(x,y)$ appears together in at least one parity check, we can apply Lemma~\ref{lem:com-code} to deduce that $G(h_\had)=\Z_2^t$. 
\end{remark}

We state our first stability result for a code-based presentation, the presentation $G(h_\had)$ defined as~\eqref{eq:def-gh-pres} where $h_\had$ is defined above. To state the result we need to specify distributions $\mu_S$ and $\mu_R$. We let $\mu_S$ be uniform over the $2^t$ generators, and $\mu_R$ the uniform distribution over the relations $R_{i}$. (Here, there is no need to place any weight on the relations $x_i^2=e$, or on the commutation relations $R'_{ijj'}$.)  

\begin{lemma}\label{lem:had-stab}
Let $\mC$ be the class of all tracial von Neumann algebras. 
The presentation $\Z_2^t= G(h_\had)$, together with the distributions $\mu_S$ and $\mu_R$ defined above, is $(\delta,\mC)$ stable with $\delta(\eps)=O(\eps)$. 
\end{lemma}

\begin{proof}
This an immediate consequence of Theorem~\ref{thm:gh}, \hnote{added:} because $G(h_\had)$ is the exhaustive presentation for $\Z_2^t$.
%\hnote{Sorry, I'm missing something here. That theorem has to do with exhaustive presentations. Is $G(h_\had)$ an exhaustive presentation -- is this because checking $g(x) + g(y) = g(x+y)$ is checking all group relations? If so this could be pointed out explicitly.}\tnote{Yes, that's the point :)}
\end{proof}



\subsection{The Reed-Muller code over $\F_q$}
\label{sec:rmq}

Fix integers $m,t \in \N$ and let $q=2^t$ and $M = 2^m$. Let $\mP(q,m,d)$ be the vector space over $\F_q$ that consists of all $m$-variate polynomials $f$ over $\F_q$ of individual degree at most $d$, that is all functions of the form
\[
	f(x_1,\ldots,x_m) = \sum_{\alpha \in \{0,1,\ldots,d\}^m} c_\alpha\,
  x_1^{\alpha_1} \cdots x_m^{\alpha_m}\;,
\]
where $\{c_\alpha\}$ is a collection of coefficients in $\F_q$. It is easy to verify that $\mP(q,m,d)$ has dimension $k = (d+1)^m$ over $\F_q$. It follows that the linear span of all $(f(x))_{x\in \F_q^m}$, when ranging over all possible $\{c_\alpha\}$, defines a $[q^m,(d+1)^m,D]_q$ linear code over $\F_q$, where $D\geq (1-md/q)q^m$ follows from the Schwartz-Zippel lemma.

\begin{lemma}[Schwartz-Zippel lemma~\cite{Sch80,Zip79}]
  \label{lem:schwartz-zippel}
  Let $f, g: \F_q^m \to \F_q$ be two unequal polynomials with total degree at most $d$. Then
  \begin{equation*}
    \Pr_{x \sim \F_q^m}\big(f(x) = g(x)\big) \leq \frac{d}{q}\;.
  \end{equation*}
\end{lemma}

\begin{remark}\label{rk:tensor-code}
\hnote{This remark seems to be floating... we haven't defined tensor codes}
We have that $\code_\RM = \code_\RS^{\otimes m}$, where $\code_\RS$ is defined as $\code_\RM$ for $m=1$.
\end{remark}


We define a local linear tester $M_{\RM}$ for the code $\code_\RM$ over $\F_q$. \hnote{added:} The tester is described as an algorithmic procedure in Figure~\ref{fig:RM-tester}. From this description it is straightforward to deduce a description of the tester as a distribution $\nu$ on subsets of $\F_q^n$, where $n=q^m$, together with vectors $v_S\in \F_q^S$ for every $S$ in the support of $\nu$. 

To describe the tester we need to introduce interpolation coefficients, as follows. For $u,v\in \F_q$ and $i\in\{0,\ldots,d\}$ \hnote{Since multiplying $\F_q$ by $\{0,1,\ldots,d\}$ doesn't necessarily make sense I think we need to interpolate with respect to some fixed $d+1$ points $t_0,\ldots,t_d \in \F_q$.} let 
\begin{equation}\label{eq:interp-coeff}
 \alpha_{u,v,i} = \frac{\prod_{\substack{i'=0\\i'\neq i}}^{d} \big(v-(u+i')\big)}{\prod_{\substack{i'=0\\i'\neq i}}^{d} \big(u+i-(u+i')\big)}\;.
\end{equation}
\hnote{I think it should be this:} Fix $d+1$ distinct values $t_0,\ldots,t_d \in \F_q$. Then for all $u,v \in \F_q$ and $i \in \{0,\ldots,d\}$ define the interpolation coefficients
 \begin{equation}\label{eq:interp-coeff}
 \alpha_{u,v,i} = \prod_{\substack{i'=0\\i'\neq i}}^{d}  \frac{v - (u + t_{i'})}{t_i - t_{i'}}~.
 \end{equation}
These are defined so that any polynomial $f:\F_q\to\F_q$ of degree at most $d$ satisfies
\[ f(v)\,=\, \sum_{i=0}^{d} \alpha_{u,v,i} \, f(u+i)\;.\]
\hnote{I think it should be:} for all $u \in \F_q$, 
\[ f(v)\,=\, \sum_{i=0}^{d} \alpha_{u,v,i} \, f(u+t_i)\;.\]

The tester verifies this relation along a randomly chosen \emph{axis-aligned direction}.  For all points $u \in \F_q^m$ and $j \in \{1,\ldots,m\}$, we say that the line through $u$ parallel to the $j$-th axis is the set of points $\{ u + te_j : t \in \F_q \}$ where $e_j=(0,\ldots,0,1,0,\ldots,0)\in \F_q^m$, where the unique $1$ is in the $j$-th position. 


\begin{figure}[!htbp]
  \centering
  \begin{gamespec}
Given access to some $g\in \F_q^n$, where $n=q^m$, identify $g$ with a function $g:\F_q^m\to \F_q$. Perform the following.
\begin{enumerate}
	\item Sample	$u\in \F_q^m$ and $j\in \{1,\ldots,m\}$ uniformly at random. Let $v$ be a uniformly random point on the line through $u$ parallel to the $j$-th axis.
	\item 
	Accept if and only if $g(v) = \sum_{i=0}^{d} \alpha_{u,v,i} g(u+i e_j)$. \hnote{I think it should be $t_i e_j$ instead of $i e_j$.}
    \end{enumerate}
  \end{gamespec}
  \caption{A local test for $\code_{\RM}$}
  \label{fig:RM-tester}
\end{figure}

\hnote{added the parity check version of this test:} A parity check matrix $h_{\RM} \in \F^{S \times q^m}$ for $\code_{\RM}$ where $S = q^m \times m \times q$ is as follows. Identify the rows with triples $(u,j,t) \in \F_q^m \times \{1,\ldots,m\} \times \F_q$. The $(u,j,t)$-th row of $h_{\RM}$ is the vector in $\F_q^m$ that for $i \in \{0,\ldots,d\}$ has the value $\alpha_{u,v,i}$ for $v = u + t e_j$ in the coordinate indexed by $u + t_i e_j$, the value $-1$ in the coordinate indexed by $u + te_j$, and the value $0$ everywhere else. 

Babai, Fortnow, and Lund essentially showed that \hnote{need to double check reference} $h_{\RM}$ is indeed a parity check matrix for $\code_{\RM}$. \hnote{There is a slight difference in that BFL chooses the $t_0,\ldots,t_d$ randomly, whereas in what I wrote above, it's a fixed choice of points.} Furthermore, they showed that the parity check matrix gives rise to a $(d+2)$-local tester for $\code_{\RM}$. 

%\begin{theorem}\label{thm:mrm-sound}
%$M_\RM$ has quantum soundness $\delta(\eps)=\poly(m,d)\cdot \poly(\eps,n^{-1})$.
%\end{theorem}

%\begin{proof}
%In~\cite{ji2022quantum} it is shown that the game $G_{\code_\RM,M_\RM}$ (played using $\F_q$ as the base field) is $(\delta,\nu)$-robust, where $\nu$ is the uniform distribution over $\F_q^m \subseteq \mX$ and $\delta$ satisfies $\delta(\eps)=\poly(m,d)\cdot \poly(\eps,n^{-1})$. The theorem follows by the second item of Proposition~\ref{prop:sound-game}. 
%\end{proof}


\subsection{Code composition}
\label{sec:code-comp}

 The Reed-Muller code from the previous section is defined over $\F_q$, for $q$ a prime power. We can transform any $q$-ary code, for $q=2^t$, into a binary code using the idea of \emph{code composition} which we now describe. 

%For $q=2^t$ and $a\in \F_q$ we let $\kappa(a)\in\F_2^t$ denote binary representation of $a$, taken in a fixed but usually left implicit self-dual basis of $\F_{q}$ over $\F_2$. 
\hnote{edited slightly:} Let $\kappa: \F_q \to \F_2^t$ denote an invertible linear map such that $\kappa(a)$ is the $\F_2$-representation of $a \in \F_q$ over some (implicitly specified) self-dual basis of $\F_q$ over $\F_2$. We extend $\kappa$ and its inverse $\kappa^{-1}$ to vectors over $\F_q$ coordinate-wise. We let $\tr(\cdot):\F_q\to\F_2$ denote the trace over $\F_2$. Because we chose a self-dual basis for the binary representation, the trace satisfies $\tr(ab)=\kappa(a)\cdot\kappa(b)$  where the right-hand side means the $\F_2$-inner product of the vectors $\kappa(a), \kappa(b)$. For more details on the $\kappa$ map and its properties, see~\cite[Section 3.3]{ji2020mip}.

Let $q=2^t$ and $\code$ an $[n,k,d]_q$ linear code. Let $\code_{\Had}$ be the Hadamard code over $\F_2^t$ (introduced at the end of Section~\ref{sec:pres-code}). 
Let $\code'$ be the $[qn,tk,d']$ linear code over $\F_2$ defined as follows. Given $a\in (\F_2^t)^{k}$, first map $a\mapsto a'=\kappa^{-1}(a) \in \F_q^{k}$. Then encode $a'$ to $b'=\code(a')\in \F_q^n$. Finally, return $b=\code_\Had(\kappa(b'))\in(\F_2^q)^n$, where $\code_\Had$ is applied component-wise. Using that $\code_\Had$ has distance $q/2$, it is easy to verify that this code has distance $d'\geq dq/2$.

Given an $r$-local $M$ for $\code$, there is a natural \hnote{should be $r$-local, right?} $rq$-local tester $M'$ for $\code'$ which can be described as follows. Index coordinates of $\code'$ by pairs $(i,\alpha)\in [n]\times\F_2^t$, fixing a bijection between $[qn]$ and $[n]\times \F_2^t$. Then $\nu'$ is the uniform mixtures of two distributions, $\nu'_1$ and $\nu'_2$, defined as follows. 

To sample from $\nu'_1$, sample $S\sim\nu$ and $\gamma\in \F_2^t$ uniformly at random \hnote{type-checking, $\gamma$ should be in $\F_q$, I think}. If $M$ performed the check $v_S \cdot u_S=0$, then perform the check 
\begin{align*}
0 &= \tr\big(( v_S \cdot u_S) \gamma\big)\\
&= \sum_{j\in S} \tr( v_{j} u_j \gamma) \\
&= \sum_{j\in S} \kappa(\gamma v_{j}) \cdot \kappa(u_j)\;.
\end{align*}
This check can be performed by evaluating $u$ at the coordinates $(j,\kappa(\gamma  v_{j}))$ for $j\in S$ and summing the results in $\F_2$. 

To sample from $\nu'_2$, sample $i\sim[n]$ uniformly at random and $x,y\in\F_2^t$ uniformly at random, and return $\{i\}\times\{x,y,x+y\}$. Execute the tester $M_\had$ for the Hadamard code, i.e.\ check if the three corresponding entries of $u$ sum to zero. 

\hnote{added the parity check version of the tester: } Let $M = (h,\nu)$ denote an $r$-local tester for $\code$, where $h \in \F_q^{\ell \times n}$ is a parity check matrix for $\code$. We now describe an $r$-local tester $M' = (h',\nu')$ for $\code'$. Define $h'$ to be the block matrix $\begin{bmatrix} A \\ B \end{bmatrix}$ where 
\begin{itemize}
	\item $A \in \F^{nq^2 \times nq}$ is itself a block-diagonal matrix where the diagonal blocks are the $q^2 \times q$ parity check matrix for the Hadamard code. 
	In other words, $A$ can be viewed as $I_{n\times n} \otimes h_\had$ where $h_\had \in \F_2^{q^2 \times q}$ is the parity check matrix for the Hadamard code. 
	\item $B \in \F^{\ell q \times nq}$ is viewed as having the rows indexed by pairs $(p,\gamma) \in \{1,\ldots,\ell\} \times \F_q$ and columns indexed by pairs $(i,x) \in \{1,\ldots,n\} \times \F_2^t$. The entry in row $(p,\gamma)$ and column $(i,x)$ is $1$ if and only if $h_{pi} \neq 0$ and $x = \kappa(\gamma h_{pi})$.
\end{itemize}
It is easy to check that $h'$ is a parity check matrix for $\code'$. Finally, define the distribution $\nu'$ to be choosing a uniformly random row of the $A$ block matrix with probability $1/2$, and choosing a uniformly random row of the $B$ block matrix with probability $1/2$. 

\hnote{maybe good to add a sentence or two of intuition about why this tester makes sense...}

\hnote{Also, probably could use another lemma or proposition here arguing that this is in fact a valid tester.}

\section{An efficient presentation for $\Z_2^k$}

Fix integers $m,t,d \in \N$ and let $q=2^t$. Let $\code_{\bRM}$ be the $[q^{m+1},t(d+1)^m,D']$ code obtained by applying the composition procedure from Section~\ref{sec:code-comp} to the $[q^m,(d+1)^m,D]_q$ Reed-Muller code $\code_\RM$ from Section~\ref{sec:rmq}. Let $N=q^{m+1}$ and $h_{\bRM}\in \F_2^{M\times N}$ the parity check matrix for $\code_{\bRM}$ obtained from the composition of the $(d+2)$-local tester for $\code_\RM$ with the $3$-local tester for $\code_\had$. Then $h_\bRM$ has $M= m\cdot q^m \cdot (1+q^2)$ rows, indexed by $(u,j)\in \F_1^m\times [m]$ and $\F_q^m\times [m] \times \F_q^2$ respectively, such that each row has at most $3(d+2)$ nonzero entries. 

Let $G_\bRM = G(h_\bRM)$ be the group that is presented from $h_\bRM$ (recall from \Cref{sec:pres-code} that codes give rise to group presentations). Explicitly, $h_\bRM$ is the parity check matrix that arises from the tester described in Figure~\ref{fig:bRM-tester}. 


\begin{figure}[!htbp]
  \centering
  \begin{gamespec}
Given access to some $g\in (\F_2^t)^n$, where $n=q^m$, identify $g$ with a function $g:(\F_2^t)^m \times \F_2^t \to \F_2$. Perform one of the following tests with probability~$\tfrac{1}{2}$ each. 
\begin{enumerate}
	\item \textbf{Low-degree test:}
		Let $u \in \F_q^m$ be a uniformly random point and $j\in \{1,\ldots,m\}$ chosen uniformly at random. Let $\ell$ be the line through $u$ in the $j$-th direction. Let $e_j=(0,\ldots,0,1,0,\ldots,0)\in \F_q^m$, where the unique $1$ is in the $j$-th position. Choose a uniformly random $v\in \ell$ and $\gamma\in \F_q$ and check that 
		\[\sum_{i=0}^d g(u+ie_j,\kappa(\gamma \alpha_{u,v,i})) \,=\, g(v,\kappa(\gamma))\;,\]
		where $\alpha_{u,v,i}$ is defined in~\eqref{eq:interp-coeff}.
	\item \textbf{Hadamard test:} Let $u\sim\F_q^m$ be chosen uniformly at random and $\alpha,\beta\in \F_2^t$ chosen uniformly at random. Check that 
	\[g(u,\alpha)+g(u,\beta)\,=\,g(u,\alpha+\beta)\;.\] 	
    \end{enumerate}
  \end{gamespec}
  \caption{A local test for $\code_{\bRM}$}
  \label{fig:bRM-tester}
\end{figure}

We do not know if $G_\bRM = \Z_2^K$, with $K=t(d+1)^m$. Instead we modify the presentation $G(h_\bRM)$ by adding pairwise commutation relations in a similar manner as Lemma~\ref{lem:com-code}. Let 
\[ G(h_\bRM) \,=\, \big\langle x_1,\ldots,x_N \;:\; \{R^\sq_k\}\,,\; \{R^\ld_k\}\,,\; \{R^\had_{k}\} \big\rangle\;,\]
where  $R^\sq_k$ ranges overal all relations of the form $x_i^2=e$ for $i\in \{1,\ldots,N\}$, $R^\ld_k$ ranges over all relations implied by the ``low-degree test'' in Figure~\ref{fig:bRM-tester} and $R^\had_{k}$ ranges over all the relations implied by the ``Hadamard test.'' For $k=(i,j)\in\{1,\ldots,N\}$ such that $i<j$ let $R^\com_k$ be the relation $[x_i,x_j]=e$.
Then we define
\begin{equation}\label{eq:z2k-eff}
 G' \,=\,\big\langle x_1,\ldots,x_N \;:\; \{R^\sq_k\}\,,\; \{R^\ld_k\}\,,\; \{R^\had_{k}\}\, , \; \{ R^\com_k\}\big\rangle\;.
\end{equation}
From Lemma~\ref{lem:com-code} it follows that $G'=\Z_2^K$. Our main result is an efficient stability result for this presentation. To state this we need to introduce distributions $\mu_S$ and $\mu_R$ on the generators and relations of $G'$. The distribution $\mu_S$ is taken to be the uniform distribution over $[N] = (\F_2^t)^m \times \F_2^t$. The distribution $\mu_R$ is obtained as follows. With probability $1/4$ each, a relation from $\{R^\sq_k\}$, $\{R^\ld_k\}$ or $\{R^\had_k\}$ is chosen uniformly at random. With probability $1/4$, a random commutation relation from $R^\com_k$ is chosen according to the uniform mixture of the following two distributions:
\begin{enumerate}
\item For the first distribution, we select $u\in \F_q^m$ uniformly at random, $j\in\{1,\ldots,m\}$ uniformly at random, and $i\neq i'\in\{0,\ldots,d\}$ uniformly at random. Finally, select $\alpha,\beta\in \F_2^t$ uniformly at random and check commutation between $x_{u+i e_j,\alpha}$ and $x_{u+i' e_j,\beta}$. 
\item For the second distribution, we first select $j\in\{1,\ldots,m\}$ and $u_{m-j+2},\ldots,u_m \in \F_2^t$ uniformly at random. Then select $v,v' \in (\F_2^t)^m$ uniformly at random, conditioned on the last $(j-1)$ coordinates matching $u_{m-j+2},\ldots,u_m$. Finally, select $\alpha,\beta\in \F_2^t$ uniformly at random and check commutation between $x_{v,\alpha}$ and $x_{v',\beta}$. 
\end{enumerate}


\begin{theorem}\label{thm:z2-stab}
Let $\mC$ be the class of all tracial von Neumann algebras. 
The presentation of  $\Z_2^K$ given in~\eqref{eq:z2k-eff}, together with the distributions $\mu_S$ and $\mu_R$ defined above, is $(\delta,\mC)$ stable with $\delta(\eps)=$. 
\end{theorem}


\begin{proof}
Let $(\mM,\tau)$ be a tracial von Neumann algebra and $\phi$ be an $\eps$-homomorphism of $\langle S:R\rangle$ on $(\mM,\tau)$. 
 Here, $S = \{s_{u,\alpha}: u\in (\F_2^t)^m, \alpha\in \F_2^t\}$. We sometimes enumerate the items of $S$ as $S=\{x_i: i\in\{1,\ldots,N\}\}$, where $N=2^{tm+t}$ and we fixed an arbitrary bijection between $(\F_2^t)^m\times \F_2^t$ and $\{1,\ldots,N\}$. Let $R$ be the set of all relations in~\eqref{eq:z2k-eff}, i.e.\ $R= \{R_k^\sq\}\cup \{R^\ld_k\}\cup\{R^\had_k\}\cup\{R^\com_k\}$. Let $N=|S|$.

We first exploit the relations $R_k^\sq$ to show that we may assume without loss of generality that $\phi$ sends each element of $S$ to a Hermitian involution. 

\begin{claim}\label{claim:z2-stab-1}
There is an $\eps^{(1)}=O(d\eps)$ and an $\eps^{(1)}$-homomorphism $\phi^{(1)}$ of $\langle S:R\rangle$ on $(\mM,\tau)$ such that $\phi^{(1)}(x)$ is a Hermitian involution for all $x\in S$, and furthermore
\begin{equation}\label{eq:z2-stab-1a}
 \Es{x\sim\mu_S} \big\| \phi(x) - \phi^{(1)}(x) \big\|_\tau^2 \,\leq\, \eps^{(1)}\;.
\end{equation}
\end{claim}

\begin{proof}
Using elementary calculations (see e.g.~\cite[Lemma 3.6]{slofstra2019set}) we see that for any complex $\alpha$, 
\[ \big| \sgn\Re\alpha-\alpha\big| \,\leq\, \Big(1+\frac{1}{\sqrt{2}}\Big) \big|\alpha^2 -1 \big|\;.\]
For any $i\in \{1,\ldots,N\}$ let $\phi^{(1)}(x_i) = \sgn\Re (\phi(x_i))$. Then the claim follows since 
\[ \Es{i\in\{1,\ldots,N\}} \big\| \phi(x_i)^2-\Id \big\|_\tau^2 \,\leq\, 4\eps\;,\]
by assumption and the definition of $\mu_R$, which places weight $\frac{1}{4}$ on the relations in $R_k^\sq$. Since $\mu_S$ is uniform on $S$,~\eqref{eq:z2-stab-1a} follows. Furthermore, because all relations in $R$ have length at most $O(d)$, $\phi^{(1)}$ is an $O(d\eps)$-homomorphism of $\langle S:R\rangle$\tnote{This requires more explanation, e.g.\ we need the marginal of any variable appearing in a relation to be uniform. I'm also not sure it's not $d^2$ instead of $d$.} 
\end{proof}

For ease of notation we relabel $\phi^{(1)}$ and $\eps^{(1)}$ as $\phi$ and $\eps$ respectively. Next we exploit the relations $\{R^\had_k\}$ to show the following. 

\begin{claim}\label{claim:z2-stab-2}
Let $q=2^t$. 
For every $u\in \F_q^m$ there is a projective measurement $\{P^u_\alpha\}_{\alpha\in \F_{q}}$ on $\mM$ such that 
\begin{equation}\label{eq:z2-stab-2}
 \Es{u\in \F_q^m} \Es{\alpha\in \F_2^t} \Big\| \phi(s_{u,\alpha}) - \sum_{\beta\in\F_q} (-1)^{\alpha \cdot \kappa(\beta)} P^u_\beta \Big\|_\tau^2 \,=\, O(\eps)\;. 
\end{equation}
\end{claim}

\begin{proof}
Since $\mu_R$ places weight $1/4$ on relations $\{R^\had_k\}$ we deduce that 
\begin{equation}\label{eq:stab-rm-1}
\Es{u\in \F_q^m} \Es{\alpha,\beta\in \F_2^t} \big\|\phi(s_{u,\alpha})\phi(s_{u,\beta})\phi(s_{u,\alpha+\beta})-\Id\big\|_\tau^2 \,\leq\, 4\eps\;. 
\end{equation}
Fix an $u\in \F_q^m$ and apply Lemma~\ref{lem:had-stab} for that $u$. This gives a partial isometry $w\in P\mM_\infty\Id_\mM$ and a unitary representation $\{U_\alpha\}$ of $\F_2^t$ on $\mN=P\mM_\infty P$ such that 
\begin{equation}\label{eq:stab-rm-1b}
 \Es{\alpha \in \F_2^t} \big\| \phi(s_{u,\alpha}) - w^* U_\alpha w \big\|_\tau^2 \,=\, O(\eps_u)\;,
\end{equation}
where $\eps_u\geq 0$ is such that $\Es{u\in \F_q^m} \eps_u = 4\eps$. Because $\{U_\alpha\}$ are a representation of the abelian group $\F_2^t$, there is a projective measurement $\{Q^u_b\}_{b\in \F_2^t}$ on $\mN$ such that $U_\alpha = \sum_b (-1)^{\alpha\cdot b} Q^u_b$. ($\{Q^u_b\}$ can be found explicitly by applying the Fourier transform, i.e.\ $Q^u_b = \sum_\alpha (-1)^{\alpha \cdot b} U_\alpha$.) Applying Lemma~\ref{lem:pull-back}, we deduce a projective measurement $\{P^u_\beta\}_{\beta\in \F_q}$ on $\mM$ such that (by the triangle inequality)
\begin{align*}
 \Es{\alpha \in \F_2^t} \Big\| \phi(s_{u,\alpha}) - \sum_{\beta\in\F_q} (-1)^{\alpha \cdot \kappa(\beta)} P^u_\beta \Big\|_\tau^2
&\leq 2 \Es{\alpha \in \F_2^t} \Big( \Big\| \phi(s_{u,\alpha}) - w^*\Big(\sum_{b\in\F_2^t} (-1)^{\alpha \cdot b} Q^u_b \Big) w \Big\|_\tau^2 \\
&\qquad\qquad+   \Big\|  \sum_{b\in\F_2^t} (-1)^{\alpha \cdot b} w^* Q^u_b w - \sum_{\beta\in\F_q} (-1)^{\alpha \cdot \kappa(\beta)} P^u_\beta \Big\|_\tau^2\Big)\\
 &\leq\, O(\eps_u) +  \sum_{\beta\in\F_q} \Big\| w^* Q^u_{\kappa(\beta)} w - P^u_{\beta} \Big\|_\tau^2\\
&\leq O(\eps_u)\;,
\end{align*}
where the first inequality follows from the triangle inequality, the second is by~\eqref{eq:stab-rm-1b} for the first term and Parseval's identity for the second, and the last by the guarantees obtained from Lemma~\ref{lem:pull-back}.
\end{proof}

\tnote{changed this, and modified everything downstream}
For $u\in \F_q^m$ let $\{P^{u}_\beta\}_{\beta \in \F_q}$ be the projective measurement obtained from Claim~\ref{claim:z2-stab-2}. For $\alpha\in \F_q$, let  
\[ U_{u,\alpha} = \sum_{\beta\in\F_q} (-1)^{\tr(\alpha\beta)} P^u_{\beta}\;.\]
%where $\omega_q = e^{2i\pi/q}$. (\tnote{added:}To define $\omega_q^\beta$ for $\beta\in \F_q$, we use the representative of $\beta$ in $\{0,\ldots,q-1\}$.)
Then $U_{u,\alpha} \in \mU(\mM)$. 

%We observe that
%\begin{equation}\label{eq:z2-stab-2a}
%\Es{u\in\F_q^m}\Es{\alpha\in \F_q} \big\| U_u^\alpha - \phi(s_{u,\kappa(\alpha)})\big\|_\tau^2 \,=\, O(\eps)\;.
%\end{equation}
%To see this, observe that for any $\alpha\in \F_q$, $\omega_q^\alpha = (-1)^{\tr(\alpha)}$. Thus from the definition of $U_u$ we get
%\begin{align*}
%U_u^\alpha &= \sum_\beta \omega_q^{\alpha\beta} P^u_\alpha\\
 %&= \sum_\beta (-1)^{\tr(\alpha\beta)} P^u_\alpha\\
%&= \sum_\beta (-1)^{\alpha\cdot \beta} P^u_\alpha\;,
%\end{align*}
%where in the last line we slightly abused notation and identified $\alpha,\beta\in\F_q$ with $\kappa(\alpha),\kappa(\beta)\in \F_2^t$ respectively. \eqref{eq:z2-stab-2a} then follows from~\eqref{eq:z2-stab-2}.

\begin{claim}\label{claim:z2-stab-2b}
For $u\in \F_q^m$, $\alpha\in\F_q$, $j\in\{1,\ldots,m\}$ and $i\in \{0,\ldots,d\}$ let $U_{i,\alpha} = U_{u+ie_j,\alpha}$ and, for all $\beta\in\F_q$, $P^{(i)}_\beta = P^{u+ie_j}_\beta$ (leaving the dependence on $u$ and $j$ implicit). Then 
\begin{equation}\label{eq:z2-stab-2b-0a}
\Es{u\in \F_q^m} \Es{\substack{j\in\{1,\ldots,m\}\\i\neq i' \in \{0,\ldots,d\}}}\Es{\alpha,\alpha'\in \F_q} \big\| \big[ U_{i,\alpha}, U_{i',\alpha'}\big]-\Id\big\|_\tau^2\,=\, O\big(\sqrt{\eps}\big)\;, 
\end{equation}
and
\begin{equation}\label{eq:z2-stab-2b-0b}
 \Es{u\in \F_q^m} \Es{j\in\{1,\ldots,m\}} \Es{\substack{v\in \F_q^m \\v_{m-j+2}=u_{m-j+2},\ldots,v_m=u_m}}\Es{\alpha,\alpha'\in \F_q} \big\| \big[ U_{u,\alpha}, U_{v,\alpha'}\big]-\Id\big\|_\tau^2\,=\, O\big(\sqrt{\eps}\big)\;,
\end{equation}
where the expectation is over a uniformly random $u$ and $j$, and a uniformly random $v$ conditioned on its last $(j-1)$ coordinates matching those of $u$, and $[U,V]=UVU^* V^*$ is the group commutator. 
\hnote{should we clarify what it means to raise a unitary to a power in a finite field? I assume there's some canonical identification of elements of $\F_q$ with $\{0,1,2,\ldots,q-1\}$?}\tnote{I got confused by this. I added a comment above. What we need is that $(\omega_q^\alpha)^\beta = \omega_q^{\alpha \beta}$, for the field multiplication $\alpha \beta$. This will not be satisfied by an arbitrary choice of representative, right?} \hnote{Yeah I'm not sure this works... the multiplication over $\F_q$ for $q = 2^t$ does not look like multiplication in $\Z_q$; it's some more complicated linear transformation that has to do with irreducible polynomials and stuff...} \hnote{why do we need to package everything into a unitary, though? The low degree test/tensor codes stuff only needs line/points measurements}\tnote{The unitary is the best way to make use of the commutation relations; I wasn't able to control the errors without them. I redid it, without $\omega$'s, doing everything as if it was $\Z_2^t$ instead of $\F_q$.}
\end{claim}

\begin{proof}
Due to the test of the relations $\{R^\com_k\}$, it holds that 
\begin{align}
\Es{u\in \F_q^m} \Es{\substack{j\in\{1,\ldots,m\} \\ i\neq i' \in \{0,\ldots,d\}}} \Es{\alpha,\beta\in \F_q} \big\| [\phi(s_{u+i e_j,\alpha}),\phi(s_{u+i' e_j,\beta})] - \Id \big\|_\tau^2&\leq 8\eps\; ,\label{eq:z2-stab-2b-1}\\
\Es{u\in \F_q^m} \Es{j\in\{1,\ldots,m\}} \Es{\substack{v\in \F_q^m \\v_{m-j+2}=u_{m-j+2},\ldots,v_m=u_m}}\Es{\alpha,\alpha'\in \F_q} \big\| [\phi(s_{u,\alpha}),\phi(s_{v,\beta})]-\Id\big\|_\tau^2&\leq 8\eps\;.\label{eq:z2-stab-2b-1b}
\end{align}
Now, for any $u,v\in \F_q^m$
\begin{align*}
\Es{\alpha,\alpha'\in \F_q} &\tau\big( U_{u,\alpha} U_{v,\alpha'} U_{u,-\alpha} U_{v,-\alpha'} \big) \\
&= \sum_{\beta,\beta',\gamma,\gamma'\in \F_q}\Es{\alpha\in \F_q} (-1)^{\tr(\alpha(\beta-\beta'))} \Es{\alpha'\in \F_q} (-1)^{\tr(\alpha'(\gamma-\gamma'))}  \tau(P^{u}_\beta P^{v}_\gamma P^{u}_{\beta'} P^{v}_{\gamma'}\big)\\
&=\sum_{\beta,\beta',\gamma,\gamma'\in \F_q}\Es{a\in\F_2^t} (-1)^{a\cdot\kappa(\beta-\beta')} \Es{a'\in\F_2^t} (-1)^{a'\cdot\kappa(\gamma-\gamma')} \tau(P^{u}_\beta P^{v}_\gamma P^{u}_{\beta'} P^{v}_{\gamma'}\big)\\
&=\Es{a,a'\in\F_2^t}  \tau\Big( \Big(\sum_{\beta\in \F_q} (-1)^{a\cdot \kappa(\beta)} P^{u}_\beta\Big) \Big(\sum_{\gamma\in \F_q} (-1)^{a'\cdot \kappa(\gamma)} P^{v}_\gamma\Big)\Big(\sum_{\beta'\in \F_q} (-1)^{a\cdot \kappa(\beta')} P^{u}_{\beta'}\Big)\Big(\sum_{\gamma'\in \F_q} (-1)^{a'\cdot \kappa(\gamma')} P^{v}_{\gamma'}\Big)\Big)\;.
\end{align*}
%Here, the second line follows since for $\beta,\beta'\in \F_q$, 
%\[ \Es{\alpha\in \F_q} \omega_q^{\alpha(\beta-\beta')}\,=\delta_{\beta,\beta'}\,=\,\Es{\alpha\in\F_2^t} (-1)^{\alpha\cdot \kappa(\beta-\beta')}\,\;.\]
%It follows that, for any distribution on $(u,v)$ such that both marginals are uniform over $\F_q^m$,
\begin{align*}
\Es{u,v} \Es{\alpha,\alpha'\in \F_q} \big\| [U_{u,\alpha} ,U_{v,\alpha'} ]-\Id\big\|_\tau^2
&= \Es{a,a'\in \F_2^t} \Big\| \Big[\sum_{\beta\in \F_q} (-1)^{a\cdot \kappa(\beta)} P^{u}_\beta ,\sum_{\beta'\in \F_q} (-1)^{a'\cdot \kappa(\beta')} P^{v}_{\beta'} \Big]-\Id\Big\|_\tau^2\\
&= \Es{\alpha,\alpha'\in \F_q} \big\| \big[ \phi(s_{u,\alpha}),\phi(s_{v,\alpha'})\big]-\Id\big\|_\tau^2+O\big(\sqrt{\eps}\big)\;,
\end{align*}
where the second line follows from Claim~\ref{claim:z2-stab-2}. Thus~\eqref{eq:z2-stab-2b-0a} follows from~\eqref{eq:z2-stab-2b-1}, and~\eqref{eq:z2-stab-2b-0b} follows from~\eqref{eq:z2-stab-2b-1b}.
\end{proof}

Now we show the following, which essentially follows from the previous claim. 

\begin{claim}\label{claim:z2-stab-3}
For every $u\in \F_q^m$ and $j\in\{1,\ldots,m\}$, there is a projective measurement $\{R^{u,j}_\alpha\}_{\alpha\in\F_q^{d+1}}$ on $\mM$ such that 
\[ \Es{u\in \F_q^m} \Es{j\in\{1,\ldots,m\}} \Es{z_0,\ldots,z_{d}\in \F_q} \Big\| U_{0,z_0}\cdots U_{d,z_d} -  \sum_{\alpha} (-1)^{\tr(\sum z_i\alpha_i)} R^{u,j}_\alpha\Big\|_\tau^2 \,=\, \poly(d,\eps)\;.\]
Similarly, for any $u,v\in \F_q^m$ there is a projective measurement $\{R^{u,v}_{\alpha,\beta}\}_{(\alpha,\beta)\in\F_q^{2}}$ on $\mM$ such that 
\[  \Es{u\in \F_q^m} \Es{j\in\{1,\ldots,m\}} \Es{\substack{v\in \F_q^m \\v_{m-j+2}=u_{m-j+2},\ldots,v_m=u_m}} \Es{y,z\in \F_q} \Big\| U_{u,z}  U_{v,y} -  \sum_{\alpha} (-1)^{ \tr(\alpha z + \beta y)} R^{u,v}_{\alpha,\beta}\Big\|_\tau^2 \,=\, \poly(\eps)\;.\]
\end{claim}

\begin{proof}
We show the first part only, as the second part is entirely analogous. Fix an $u\in \F_q^m$ and a direction $j\in \{1,\ldots,m\}$. Define
$\psi: (\Z_2^{t})^{d+1} \to \mU(\mM)$ by 
\[\psi(z_0,\ldots,z_{d}) \,=\, U_{0,z_0} \cdots U_{d,z_{d}}\;,\]
where for each $i\in\{0,\ldots,d\}$ and $z_i\in \F_q$, $U_{i,z_i}$ is the unitary defined in Claim~\ref{claim:z2-stab-2b} and we slightly abused notation to identify $z_i\in \Z_2^t$ with the unique $\tilde{z}_i\in \F_q$ such that $\kappa(\tilde{z}_i)=z_i$ . Using Claim~\ref{claim:z2-stab-2b} and the triangle inequality we verify that the map $\psi$ is a $\delta=O(d^4\sqrt{\eps})$-approximate homomorphism of $\Z_2^{t(d+1)}$ on $\mU(\mA)$, with respect to the exhaustive presentation. To verify this first note that for any unitaries $V,W$, and any $i,i'$ we have that on average over $u$ and $j$,
\begin{align*}
\Es{\alpha,\alpha'\in \F_q} \big\| V U_{i,\alpha} U_{i',\alpha'} W^* - V U_{i',\alpha'} U_{i,\alpha}  W^*\big\|_\tau^2 \,=\, O\big(d^2 \sqrt{\eps}\big)\;,
\end{align*}
by Claim~\ref{claim:z2-stab-2b}, where the factor $d^2$ is because we require the relation to hold for all $i,i'$. Moreover, $U_{i,\alpha}U_{i,\alpha'}=U_{i,\alpha+\alpha'}$ by definition. Applying these relation $O(d^2)$ times gives
\begin{align*}
 \Es{z_0,\ldots,z_d\in\F_2^t}\Es{y_0,\ldots,y_d\in\F_2^t}\big\|\psi(z_0,\ldots,z_d)\psi(y_0,\ldots,y_d) -\psi(z_0+y_0,\ldots,z_d+y_d)\big\|_\tau^2 \,=\, O\big(d^4 \sqrt{\eps}\big)\;,
\end{align*}
as desired.
Thus we may apply Theorem~\ref{thm:gh} to obtain a partial isometry $w\in P\mM_\infty\Id_\mM$ and a family of commuting unitaries $\{V_{i,k}\}$ of order $2$ each on $\mN=P\mM_\infty P$ such that, on average over $u$ and $j$, defining $V_i^z = \prod_{k=1}^t V_{i,k}^{z_k}$,
\begin{equation}\label{eq:z2-stab-3-1}
\Es{z_0,\ldots,z_{d}\in\F_2^t} \big\| \psi(z_0,\ldots,z_{d+1}) - w^* V_0^{z_0}\cdots V_{d}^{z_{d}} w \big\|_\tau^2 \,=\, \poly(d,\eps)\;.
\end{equation}
Because $\{V_{i,z}\}$ are a representation of $\Z_2^{t(d+1)}$ (which is Abelian), there is a projective measurement $\{Q_\alpha\}_{\alpha\in \Z_2^{t(d+1)}}$ on $\mN$ such that for each $i\in\{0,\ldots,d\}$, 
\[ V_{i}^{z} \,=\, \sum_{\alpha\in (\Z_2^{t})^{d+1}} (-1)^{\alpha_{i}\cdot z} Q_\alpha\;,\]
and  
\[ V_{0}^{z_0}\cdots V_{d}^{z_{d}}  \,=\, \sum_{\alpha\in (\Z_2^{t})^{d+1}} (-1)^{\sum \alpha_{i}\cdot z_i} Q_\alpha\;.\]
Identifying $\alpha$ with an element of $\F_q^{d+1}$, and interpreting $z_i$ as an element of $\F_q$ as well,
 the preceding equation can be rewritten as
\[ V_{0}^{z_0}\cdots V_{d}^{z_{d}}  \,=\, \sum_{\alpha\in \F_q^{d+1}} (-1)^{\tr(\sum \alpha_{i} z_i} Q_\alpha\;.\]

%($\{Q^u_\alpha\}$ can be found explicitly by applying the Fourier transform.) 
Applying Lemma~\ref{lem:pull-back}, we deduce a projective measurement $\{R^{u,j}_\alpha\}_{\alpha\in (\F_q)^{d+1}}$  on $\mM$ such that by~\eqref{eq:z2-stab-3-1}, on average over $u$ and $j$,
\[  \Es{z_0,\ldots,z_{d}\in\F_q} \Big\| \psi(z_0,\ldots,z_{d}) -  \sum_{\alpha\in (\F_q^{d+1}} (-1)^{\tr(\sum z_i\alpha_i)} R_\alpha^{u,j}\Big\|_\tau^2 \,=\, \poly(d,\eps)\;.\]
\end{proof}



Next we exploit the relations $\{R^\ld_k\}$ to obtain the following. 

\begin{claim}\label{claim:z2-stab-5}
Use the same notation as in Claim~\ref{claim:z2-stab-2b}. Let $u\in \F_q^m$, $\ell$ an axis-parallel line through $u$ and $v\in\F_q^m\cap \ell$. Let $(\alpha_{u,v,i})_{i=0,\ldots,d}$ be the interpolation coefficients~\eqref{eq:interp-coeff}. %Let $U_v = \sum_\beta \omega^\beta P^v_\beta$. 
Then 
\begin{equation}\label{eq:z2-stab-5-0}
\Es{u\in\F_q^m} \Es{\ell: u\in \ell} \Es{v\in \ell} \Es{\gamma\in\F_q} \Big\| U_{0,\gamma \alpha_{u,v,0}}\cdots U_{d,\gamma  \alpha_{u,v,d}} - U_{v,\gamma} \big\|_\tau^2 \,=\, 1-O\big(d\sqrt{\eps}\big)\;,
\end{equation}
where the expectation is over a uniformly random axis-parallel line that contains $u$, and a uniformly random $v\in\ell$. 
\end{claim}

\begin{proof}
Write $\alpha_i$ for $\alpha_{u,v,i}$. 
We observe that 
\begin{align*}
\Es{\gamma\in\F_q} \tau\big( U_{0,\gamma\alpha_{0}}\cdots U_{d,\gamma\alpha_{d}} U_{v,-\gamma} \big)
&=  \sum_{\beta_0,\ldots,\beta_d\in\F_q}\sum_{\beta\in\F_q} \Es{\gamma\in\F_q} (-1)^{\tr(\sum \gamma \alpha_i\beta_i)} (-1)^{\tr(-\gamma\beta)} \tau\big( P^{(0)}_{\beta_0} \cdots P^{(d)}_{\beta_d} P^v_\beta \big)\\
&= \sum_{\beta_0,\ldots,\beta_d\in\F_q}\sum_{\beta\in\F_q}\Es{\gamma\in\F_2^t} (-1)^{\gamma\cdot \kappa(\sum \alpha_i\beta_i-\beta)} \tau\big( P^{(0)}_{\beta_0} \cdots P^{(d)}_{\beta_d} P^v_\beta \big)\\
&=\Es{\gamma\in\F_2^t}  \tau\Big( \Big(\sum_{\beta_0\in \F_q} (-1)^{\gamma\cdot \kappa(\alpha_0\beta_0)} P^{(0)}_{\beta_0} \Big)\cdots\Big(\sum_{\beta\in \F_q} (-1)^{-\gamma\cdot \kappa(\beta)} P^{v}_{\beta} \Big)\Big)\\
&=\Es{\gamma\in\F_q}  \tau\Big( \Big(\sum_{\beta_0\in \F_q} (-1)^{\kappa( \gamma \alpha_0)\cdot\kappa(\beta_0)} P^{(0)}_{\beta_0} \Big)\cdots\Big(\sum_{\beta\in \F_q} (-1)^{\kappa(-\gamma)\cdot \kappa(\beta)} P^{v}_{\beta} \Big)\Big)\;.
\end{align*}
By repeated application of Claim~\ref{claim:z2-stab-2}, the last expression is within $O(d\sqrt{\eps})$ of 
\[ \Es{\gamma\in\F_q}  \tau\big( \phi(s_{u+ie_j,\kappa(\gamma \alpha_0)})\cdots \phi(s_{v,\kappa(-\gamma)}) \big)\;.\]
The latter expression is a random relation in $R^\ld_k$, and so, on average over $u,j$ and $v$ it is $1-O(\eps)$.
\end{proof}


\begin{claim}\label{claim:z2-stab-4}
For every axis-parallel line $\ell$ there is a projective measurement $\{Q^\ell_g\}$ with outcomes $g$ that range over degree-$d$ polynomials on $\ell$ such that
\[ \Es{\ell\subset \F_q^m} \Es{v\in \ell} \sum_g \tau\big( P^v_{g(v)} Q^\ell_g\big) \,\geq\, 1-\poly(d,\eps)\;, \]
where the expectation is over a uniformly random axis-parallel line $\ell$ and point $v\in \ell$. 
\end{claim}

\begin{proof}
First we show that the conclusion of Claim~\ref{claim:z2-stab-3} can be strengthened to hold for \emph{every} $z_0,\ldots,z_{d}$, instead of on average. To show this, note that for any $y_0,\ldots,y_d\in \F_q$ we can write 
\[ U_{0,z_0}\cdots U_{d,z_d}\,=\, U_{0,y_0}U_{0,z_0-y_0}\cdots U_{d,y_d}U_{d,z_d-y_d}\;.\]
By repeated application of Claim~\ref{claim:z2-stab-2b}, the term on the right-hand side satisfies 
\[ \big\| U_{0,y_0}U_{0,z_0-y_0}\cdots U_{d,y_d}U_{d,z_d-y_d}  - U_{0,y_0}\cdots U_{d,y_d}U_{0,z_0-y_0}\cdots U_{d,z_d-y_d}\big\|_\tau^2 \,=\,\poly(d,\eps)\;.\]
To show this it suffices to verify that we only need to ``commute'' pairs of terms whose exponents are independent and uniformly random. Using Claim~\ref{claim:z2-stab-3} twice, the right-hand side satisfies
\[ \big\| U_{0,y_0}\cdots U_{d,y_d}U_{0,z_0-y_0}\cdots U_{d,z_d-y_d} - \Big(\sum_{\alpha} \omega^{\sum y_i\alpha_i} R^{u,j}_\alpha\Big)\Big(\sum_{\alpha} (-1)^{\tr(\sum (z_i-y_i)\alpha_i)} R^{u,j}_\alpha\Big) \big\|_\tau^2 \,=\,\poly(d,\eps)\;.\]
Since $\{R^{u,j}_\alpha\}$ is a projective measurement, we get the desired conclusion: on average over $u$ and $j$, for any $z_0,\ldots,z_d\in\F_q$, it holds that 
\begin{equation}\label{eq:z2-stab-4-1}
 \Big\| U_{0,z_0}\cdots U_{d,z_d} -  \sum_{\alpha} (-1)^{\tr(\sum x_i\alpha_i)} R^{u,j}_\alpha\Big\|_\tau^2 \,=\, \poly(d,\eps)\;.
	\end{equation}
	For any line $\ell \subset \F_q^m$, let $u_\ell\in \ell$ be chosen such that, for a uniformly random $\ell$ and conditioned on that $u_\ell$,~\eqref{eq:z2-stab-4-1} and~\label{eq:z2-stab-5-0} both hold, with right-hand side multiplied by a factor at most $2$. For any $\ell$ in the $j$-th direction and degree-$d$ polynomial $g$, let $Q^\ell_g = R^{u_\ell,j}_{g(u_\ell),\ldots,g(u_\ell+de_j)}$.
	Combining the two equations we deduce
	\begin{equation}\label{eq:z2-stab-4-2}
 \Es{\gamma\in\F_q} \Big\| U_v^\gamma -  \sum_{g} (-1)^{\tr(\gamma \sum \alpha_{u_\ell,v,i} g(u_\ell+ie_j))} Q^{\ell}_g\Big\|_\tau^2 \,=\, \poly(d,\eps)\;.
	\end{equation}
	By definition, $\sum \alpha_{u_\ell,v,i} g(u_\ell+ie_j) = g(v)$. By Fourier transform, we obtain the desired conclusion. 
\end{proof}


We are now in a position to apply~\cite[Theorem 4.1]{ji2022quantum}. For this we need to define a synchronous strategy in the tensor code test $\code^{\otimes m}$, where $\code$ is the Reed-Solomon code with degree $d$ over $\F_q$, and thus $\code^{\otimes m}$ is the code $\code_\RM$ is the code considered in Section~\ref{sec:rmq}. For the ``points measurement'' $A^u$ we choose $P^u$. For the ``lines measurement'' $B^\ell$ we choose $Q^\ell$ from Claim~\ref{claim:z2-stab-4}. Finally, for the ``pair measurement'' $P^{u,v}$ we choose $R^{u,v}$ from Claim~\ref{claim:z2-stab-3}. By Claim~\ref{claim:z2-stab-4} this strategy succeeds with probability $1-\poly(d,\eps)$ in the ``axis-parallel lines test'', and by Claim~\ref{claim:z2-stab-3} it succeeds with probability $1-\poly(\eps)$ in the ``subcube commutation test.'' Applying~\cite[Theorem 4.1]{ji2022quantum} we deduce a projective measurement $\{G_c\}_{c\in\code^{\otimes m}}$ on $\mA$ such that
\[ \Es{u\in\F_q^m} \sum_{c\in\code^{\otimes m}} \tau\big( G_c P^u_{c(u)}\big) \geq 1-\eta\;,\]
where $\eta = \poly(m,d,r) \cdot\poly(\eps,q^{-1},e^{-\Omega(r/m^2)})$, with $r\geq 12mt$ an (arbitrary) integer.

\end{proof}








\section{Applications: nonlocal games}
	

\subsection{The code game}
\tnote{This section is a dump---what do we need?}

To make the connection with the literature on non-local games we associate a game $G_{\code,M}$ to any code $\code$ and local tester $M$ for it. In the game, one player is asked to provide an assignment to all variables in the set $S$ queried by the tester, that will satisfy its test, while the other player is asked to provide an assignment to a single $i\in S$, and checked for consistency with the first player. The formal definition follows.  

\begin{definition}
Let $\code$ be an $[n,k,d]_q$ linear code and $M$ an $r$-local tester for $\code$. The game $G_{\code,M}$ is defined as follows. We set 
\[\mX = \{ S\subseteq \{1,\ldots,n\},|S|\leq r\} \sqcup\{1,\ldots,n\}\quad\text{and}\quad \mu(S,i)=\frac{1_{i\in S}}{|S|}\nu(S)\;,\]
and for any $S,i\in\mX$, $\mA(S)=\F_q^S$ and $\mA(i)=\F_q$, and finally $D(S,i,a,b)=M(S,a)1_{a_i=b}$. 
\end{definition}

We show the following. It is a variation on~\cite[Proposition 3.4]{slofstra2019set}.

\begin{proposition}\label{prop:sound-game}
Let $\code$ be an $[n,k,d]_q$ linear code and $M$ an $r$-local tester for $\code$ with distribution $\nu$. Let $\delta,\delta':[0,1]\to[0,1]$. Then if $\phi:\code\to \mU(\mA)$ is an $\eps$-homomorphism, there is a strategy $\strategy$ for $G_{\code,\mM}$ on $(\mN,\tau^\mN)$ such that the second prover's projective measurements are $\{\phi(i)\}_{1\leq i \leq n}$ and $\omega^*(\G_{\code,M},\strategy)\geq 1-\eps$. 
\end{proposition}

We note that a converse to the proposition also holds. The converse is easier and we will not need it, so we skip it. 

\begin{proof}
Let $\phi$ be an $\eps$-homomorphism of $G=\langle S:R\rangle$ on $(\mM,A)$. For each $S$ in the support of $\mu$ and $i\neq j \in S$ the constraint $[x_i,x_j]=e$ appears in $R$. Therefore, the restriction of $\phi$ to $S$ is an $\eps_S$-homomorphism of $\Z_2^S$, where $\eps_S$ is such that $\Es{S\sim \mu} \eps_S = O(\eps)$. Applying Lemma~\ref{lem:eff-z2} we deduce that there is a family $\{P^S_a\}_{a\in \F_2^S}$ of projective measurements on $(\mM,A)$ that satisfy 
\[ \Es{S \sim \nu} \Es{i\in S} \sum_{a \in \F_q} \big\| \phi(i)_a - P^S_a \big\|_\tau^2  \,\leq\,O(\eps)\;.\]
\end{proof}

Later we also use the following proposition, which relates the code games obtained before and after code composition. 


\begin{proposition}\label{prop:q-to-2}
Let $\code$ be an $[n,k,d]_q$ code and $M$ an $r$-local tester for it. Let $M'$ be the $rq$-local tester for $\code'$ obtained as above. Let $\strategy'$ be such that $\omega^*(G_{\code',M'},\strategy')\geq 1-\eps$. Then there is a strategy $\strategy$ for $G_{\code,M}$ such that \tnote{some closeness condition} 
\end{proposition}

\begin{proof}
Let $\strategy'$ be such that $\omega^*(G_{\code',M'},\strategy')\geq 1-\eps$. Restricting to questions in the support of $\nu'_2$, for each $i$ we obtain an $\eps_i$ and a strategy $\strategy_i$ for $G_{\had,M_\had}$ that succeeds with probability $1-\eps_i$, and $\Es{i} \eps_i \leq 2\eps$. 

By quantum soundness of $\code_\Had$ (Theorem~\ref{thm:had-qsound}\tnote{adapt}), for each $i$ there exists commuting $\{\hat{A}^{(i,\alpha)}\}$ that are $O(\eps_i)$-close to the $\{A^{(i,\alpha)}\}$ and moreover are a representation of $\code_{\Had}$. Let $w^{(i)}$ be the implied isometry. For every $a\in \F_2^t$, define $\hat{A}^{i}_{a}=\Es{\alpha}(-1)^{a\cdot \alpha} \hat{A}^{(i,\alpha)}$. Then by linearity this is a projective measurement:
\begin{align*}
\big(\hat{A}^{i}_{a}\big)^2 &=\Big(\Es{\alpha}(-1)^{a\cdot \alpha} \hat{A}^{(i,\alpha)}\Big)^2\\
&= \Es{\alpha,\alpha' }(-1)^{a\cdot (\alpha+\alpha')} \hat{A}^{(i,\alpha)}\hat{A}^{(i,\alpha')}\\
&=\Es{\alpha,\alpha' }(-1)^{a\cdot (\alpha+\alpha')} \hat{A}^{(i,\alpha+\alpha')}\\
&=\hat{A}^{i}_{a}\;,
\end{align*}
where the third line uses that  $\{A^{(i,\alpha)}\}$ are a representation of $\code_{\Had}$. Moreover, $\sum_a \hat{A}^{i}_{a} = \hat{A}^{(i,0)}=\Id$. Hence using Lemma~\ref{lem:pull-back}, for every $i$ we obtain a projective measurement $\{\tilde{A}^{i}_{a}\}$ on $\cM$ such that
\begin{equation}\label{eq:qto2-1a}
 \sum_a \big\| \tilde{A}^i_a - (w^{(i)})^* \hat{A}^i_a (w^{(i)}) \big\|_2^2 \,=\, O(\eps_i)\;.
\end{equation}
%Moreover,
%\begin{equation}\label{eq:qto2-1}
%\Es{i} \Es{\alpha}  \Big\| A^{(i,\alpha)} - \sum_a (-1)^{a\cdot\alpha}(w^{(i)})^* \hat{A}^i_a (w^{(i)})\Big\|^2
%\,=\, \Es{i} \Es{\alpha}  \big\| A^{(i,\alpha)} - (w^{(i)})^* \hat{A}^{i,\alpha} (w^{(i)})\big\|^2 \,=\, O(\eps)\;,
%\end{equation}
%by closeness. Combining~\eqref{eq:qto2-1a} with~\eqref{eq:qto2-1} through the triangle inequality gives
We then get
\begin{align}
 \Es{i} \sum_a \Big\| \Es{\alpha} (-1)^{a\cdot \alpha} A^{(i,\alpha)} -  \tilde{A}^i_a \Big\|_2^2 
&\leq  2\Es{i} \sum_a \Big\| \Es{\alpha} (-1)^{a\cdot \alpha} A^{(i,\alpha)} -  (w^{(i)})^* \hat{A}^i_a (w^{(i)}) \Big\|_2^2 + O(\eps)\notag\\
&=  2\Es{i} \sum_a \Big\| \Es{\alpha} (-1)^{a\cdot \alpha} A^{(i,\alpha)} -   \Es{\alpha} (-1)^{a\cdot \alpha} (w^{(i)})^* \hat{A}^{i,\alpha} (w^{(i)}) \Big\|_2^2+ O(\eps) \notag\\
&= 2\Es{i} \Es{\alpha} \big\| A^{(i,\alpha)} -    (w^{(i)})^* \hat{A}^{i,\alpha} (w^{(i)}) \big\|_2^2+ O(\eps)\notag\\
&= O(\eps)\;, \label{eq:qto2-2}
\end{align}
where the first line uses the triangle inequality and~\eqref{eq:qto2-1a}, the second line uses the definition of $\hat{A}^i_a$, the third line is Parseval's identity and the last is by closeness. 

Now for $b\in \F_q$ define $\tilde{B}^{S,i}_b= \Es{\alpha} (-1)^{b\cdot \alpha} B^{S\times \F_2^t,(i,\alpha)}$, which for the same reasons as earlier is a projective measurement. 
To conclude we show that $\{\tilde{A}^{i}\}$ and $\{\tilde{B}^{S,i}\}$ form a strategy in $G_{\code, M}$ that succeeds with probability $1-O(\eps)$. This is because
\begin{align*}
\Es{S}\Es{i} \sum_b \big\| \tilde{A}^i_b - \tilde{B}^{S,i}_b \big\|_2^2
&\leq 2\Es{S}\Es{i} \sum_b \Big\| \Es{\alpha} (-1)^{b\cdot \alpha} {A}^{(i,\alpha)} - \Es{\alpha} (-1)^{b\cdot \alpha} B^{S\times \F_2^t,(i,\alpha)}\Big\|_2^2 + O(\eps)\\
&= 2\Es{S}\Es{i} \Es{\alpha}\big\|  {A}^{(i,\alpha)} -  B^{S\times \F_2^t,(i,\alpha)}\big\|_2^2 + O(\eps)\\
&\leq 4\eps + O(\eps)\;,
\end{align*}
where the first inequality is by~\eqref{eq:qto2-2} and the triangle inequality, the second line by Parseval's formula and the last is by assumption. 
\end{proof}

\subsection{The Pauli braiding test}

\subsection{Qubit tests}

\subsection{Dimension bounds}


Formulate the PBT as an LCS. Get soundness as a corollary. 





\bibliography{qld}

\notesendofpaper

\end{document}
